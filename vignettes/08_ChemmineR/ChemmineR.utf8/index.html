<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>_ChemmineR_: Cheminformatics Toolkit for R  | Manuals</title>
<link rel="stylesheet" href="/manuals/css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/manuals/css/modern-business.css">
<link rel="stylesheet" href="/manuals/css/lavish-bootstrap.css">
<link rel="stylesheet" href="/manuals/css/customstyles.css">
<link rel="stylesheet" href="/manuals/css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/manuals/js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="/manuals/js/toc.js"></script>
<script src="/manuals/js/customscripts.js"></script>

<link rel="shortcut icon" href="/manuals/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://idratherbewriting.com/manuals/feed.xml">




 
    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="/manuals/">&nbsp;<span class="projectTitle"> Data Analysis Tutorials</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="/manuals/news/">News</a></li>
                
                
                
                <li><a href="/manuals/news/">News</a></li>
                
                
                
                <li><a href="/manuals/news/">News</a></li>
                
                
                
                <li><a href="/manuals/news/">News</a></li>
                
                
                
                <li><a href="/manuals/news/">News</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Jekyll Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/tomjohnson1492/documentation-theme-jekyll" target="_blank">Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://talk.jekyllrb.com" target="_blank">Jekyll Talk</a></li>
                        
                        
                        
                        <li><a href="http://jekyllrb.com/docs/home/" target="_blank">Jekyll documentation</a></li>
                        
                        
                        
                        <li><a href="http://stackoverflow.com/questions/tagged/jekyll" target="_blank">Jekyll on Stack Overflow</a></li>
                        
                        
                        
                        <li><a href="http://idratherbewriting.com/category-jekyll/" target="_blank">Jekyll on my blog</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Products<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="/manuals/mydoc_introduction/">Jekyll Documentation Theme</a></li>
                        
                        
                        
                        <li><a href="/manuals/p1_landing_page/">Product 1</a></li>
                        
                        
                        
                        <li><a href="/manuals/p2_landing_page/">Product 2</a></li>
                        
                        
                        
                        <li><a href="/manuals/home/">Manuals</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<!-- Send feedback function -->
<script>
function SendLinkByMail(href) {
var subject= "Manuals feedback";
var body = "I have some feedback about the _ChemmineR_: Cheminformatics Toolkit for R page: ";
body += window.location.href;
body += "";
var uri = "mailto:tomjohnson1492@gmail.com?subject=";
uri += encodeURIComponent(subject);
uri += "&body=";
uri += encodeURIComponent(body);
window.location.href = uri;
}
</script>

<li><a href="javascript:(function()%7BSendLinkByMail()%3B%7D)()%3B" target="_blank"><i class="fa fa-envelope-o"></i> Feedback</a></li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/manuals/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: '/manuals/search.json',
                                searchResultTemplate: '<li><a href="{url}" title="_ChemmineR_: Cheminformatics Toolkit for R">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>
<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          














<ul id="mysidebar" class="nav">
    <li class="sidebarTitle"> </li>
    
    
    
        
    
    <li>
        <a href="#">Overview</a>
        <ul>
            
            
            
            <li><a href="/manuals/home/">Introduction</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_classes/">Class teaching</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Introduction to R</a>
        <ul>
            
            
            
            <li><a href="/manuals/manuals/mydoc_Rbasics_1/">1. Overview</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_Rbasics_2/">2. R Package Repositories</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_Rbasics_3/">3. Installation of R and Add-on Packages</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_Rbasics_4/">4. Getting Around</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_Rbasics_5/">5. Basic Syntax</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_Rbasics_6/">6. Data Types</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_Rbasics_7/">7. Data objects</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_Rbasics_8/">8. Graphics example</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_Rbasics_9/">9. Session Info</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">ChemmineR</a>
        <ul>
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_01/">1. Introduction</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_02/">2. Getting Started</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_03/">3. OpenBabel Functions</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_04/">4. Overview of Classes and Functions</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_05/">5. Import of Compounds</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_06/">6. Export of Compounds</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_07/">7. Format Interconversions</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_08/">8. Splitting SD Files</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_09/">9. Streaming Through Large SD Files</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_10/">10. Storing Compounds in an SQL Database</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_11/">11. Working with SDF/SDFset Classes</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_12/">12. Molecular Property Functions (Physicochemical Descriptors)</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_13/">13. Bond Matrices</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_14/">14. Charges and Missing Hydrogens</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_15/">15. Ring Perception and Aromaticity Assignment</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_16/">16. Rendering Chemical Structure Images</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_17/">17. Similarity Comparisons and Searching</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_18/">18. Clustering</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_19/">19. Searching PubChem</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_20/">20. ChemMine Tools R Interface</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_21/">21. Version Information</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_22/">22. Funding</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_ChemmineR_23/">23. References</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">bioassayR</a>
        <ul>
            
            
            
            <li><a href="/manuals/manuals/mydoc_bioassayR_1/">1. Introduction</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_bioassayR_2/">2. Getting Started</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_bioassayR_3/">3. Examples</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_bioassayR_4/">4. Building PubChem BioAssay Database</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_bioassayR_5/">5. Version Information</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_bioassayR_6/">6. Funding</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_bioassayR_7/">7. References</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">systemPipeR</a>
        <ul>
            
            
            
            <li><a href="/manuals/manuals/mydoc_systemPipeR_1/">1. Introduction</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_systemPipeR_2/">2. Getting Started</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_systemPipeR_3/">3. Workflow overview</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_systemPipeR_4/">4. Workflow templates</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_systemPipeR_5/">5. Version information</a></li>
            
            
            
            
            
            
            <li><a href="/manuals/manuals/mydoc_systemPipeR_6/">6. References</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Internal notes</a>
        <ul>
            
            
            
            <li><a href="/manuals/manuals/mydoc_internal_notes/">Administration of site</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>
    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">_ChemmineR_: Cheminformatics Toolkit for R</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    <a target="_blank" href="https://github.com/tomjohnson1492/documentation-theme-jekyll/blob/gh-pages//vignettes08_ChemmineRChemmineR.utf8.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
    

    

  <!--
%% \VignetteEngine{knitr::rmarkdown}
%% \VignetteEncoding{UTF-8}
%\VignetteIndexEntry{ChemmineR}
%% \VignetteDepends{ChemmineOB, fmcsR, ChemmineDrugs}
%% \VignetteKeywords{cheminformatics, structural searching, clustering}
%% \VignettePackage{ChemmineR}
-->

<!---
- Compile from command-line
echo "rmarkdown::render('ChemmineR.Rmd'), clean=F" | R -slave; R CMD Stangle ChemmineR.Rmd; 
Rscript ../md2jekyll.R ChemmineR.knit.md 7

- Commit to github
git commit -am "some edits"; git push -u origin master

- To customize font size and other style features, add this line to output section in preamble:  
    css: style.css
-->

<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script>

<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script>

<p>Note: the most recent version of this tutorial can be found <a href="https://htmlpreview.github.io/?https://github.com/girke-lab/ChemmineR/blob/master/vignettes/ChemmineR.html">here</a> and a short overview slide show <a href="http://faculty.ucr.edu/~tgirke/HTML_Presentations/Manuals/Workshop_Dec_5_8_2014/Rcheminfo/Cheminfo.pdf">here</a>.</p>

<h1 id="introduction">Introduction</h1>

<p><code class="highlighter-rouge">ChemmineR</code> is a cheminformatics package for analyzing
drug-like small molecule data in R. Its latest version contains
functions for efficient processing of large numbers of small molecules,
physicochemical/structural property predictions, structural similarity
searching, classification and clustering of compound libraries with a
wide spectrum of algorithms.</p>

<p><img src="overview.png" alt="Figure: `ChemmineR` environment with its add-on packages and selected functionalities" /></p>

<p>In addition, <code class="highlighter-rouge">ChemmineR</code> offers visualization functions
for compound clustering results and chemical structures. The integration
of chemoinformatic tools with the R programming environment has many
advantages, such as easy access to a wide spectrum of statistical
methods, machine learning algorithms and graphic utilities. The first
version of this package was published in Cao et al. [-@Cao_2008]. Since then many additional
utilities and add-on packages have been added to the environment (Figure 2) and
many more are under development for future releases [@Backman_2011; @Wang_2013].</p>

<p>&lt;/br&gt;</p>

<p><strong>Recently Added Features</strong></p>

<ul>
  <li>
    <p>Improved SMILES support via new <code class="highlighter-rouge">SMIset</code> object class
and SMILES import/export functions</p>
  </li>
  <li>
    <p>Integration of a subset of OpenBabel functionalities via new
<code class="highlighter-rouge">ChemmineOB</code> add-on package [@Cao_2008]</p>
  </li>
  <li>
    <p>Streaming functionality for processing millions of molecules on a
laptop</p>
  </li>
  <li>
    <p>Mismatch tolerant maximum common substructure (MCS) search algorithm</p>
  </li>
  <li>
    <p>Fast and memory efficient fingerprint search support using atom pair
or PubChem fingerprints</p>
  </li>
</ul>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="getting-started">Getting Started</h1>

<h2 id="installation">Installation</h2>

<p>The R software for running ChemmineR can be downloaded from CRAN
(<a href="http://cran.at.r-project.org/">http://cran.at.r-project.org/</a>). The ChemmineR package can be
installed from R using the <code class="highlighter-rouge">bioLite</code> install command.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">source</span><span class="p">(</span><span class="s2">"http://bioconductor.org/biocLite.R"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Sources the biocLite.R installation script. 
</span><span class="w"> </span><span class="n">biocLite</span><span class="p">(</span><span class="s2">"ChemmineR"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Installs the package. 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="loading-the-package-and-documentation">Loading the Package and Documentation</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="s2">"ChemmineR"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Loads the package
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">"ChemmineR"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Lists all functions and classes 
</span><span class="w"> </span><span class="n">vignette</span><span class="p">(</span><span class="s2">"ChemmineR"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Opens this PDF manual from R 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="five-minute-tutorial">Five Minute Tutorial</h2>

<p>The following code gives an overview of the most important
functionalities provided by <code class="highlighter-rouge">ChemmineR</code>. Copy and paste
of the commands into the R console will demonstrate their utilities.</p>

<p>Create Instances of <code class="highlighter-rouge">SDFset</code> class:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">sdfsample</span><span class="p">)</span><span class="w"> 
 </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfsample</span><span class="w">
 </span><span class="n">sdfset</span><span class="w"> </span><span class="c1"># Returns summary of SDFset 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "SDFset" with 100 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="c1"># Subsetting of object
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "SDFset" with 4 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="w"> </span><span class="c1"># Returns summarized content of one SDF
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "SDF"
## 
## &lt;&lt;header&gt;&gt;
##                             Molecule_Name                                    Source 
##                                  "650001"                  "  -OEChem-07071010512D" 
##                                   Comment                               Counts_Line 
##                                        "" " 61 64  0     0  0  0  0  0  0999 V2000" 
## 
## &lt;&lt;atomblock&gt;&gt;
##           C1      C2  C3  C5  C6  C7  C8  C9 C10 C11 C12 C13 C14 C15 C16
## O_1   7.0468  0.0839   0   0   0   0   0   0   0   0   0   0   0   0   0
## O_2  12.2708  1.0492   0   0   0   0   0   0   0   0   0   0   0   0   0
## ...      ...     ... ... ... ... ... ... ... ... ... ... ... ... ... ...
## H_60  1.8411 -1.5985   0   0   0   0   0   0   0   0   0   0   0   0   0
## H_61  2.6597 -1.2843   0   0   0   0   0   0   0   0   0   0   0   0   0
## 
## &lt;&lt;bondblock&gt;&gt;
##      C1  C2  C3  C4  C5  C6  C7
## 1     1  16   2   0   0   0   0
## 2     2  23   1   0   0   0   0
## ... ... ... ... ... ... ... ...
## 63   33  60   1   0   0   0   0
## 64   33  61   1   0   0   0   0
## 
## &lt;&lt;datablock&gt;&gt; (33 data items)
##           PUBCHEM_COMPOUND_CID PUBCHEM_COMPOUND_CANONICALIZED      PUBCHEM_CACTVS_COMPLEXITY 
##                       "650001"                            "1"                          "700" 
##  PUBCHEM_CACTVS_HBOND_ACCEPTOR                                
##                            "7"                          "..."
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Returns summarized content of many SDFs, not printed here 
</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Returns complete content of many SDFs, not printed here 
</span></code></pre>
</div>

<p>An <code class="highlighter-rouge">SDFset</code> is created during the import of an SD file:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.SDFset</span><span class="p">(</span><span class="s2">"http://faculty.ucr.edu/ tgirke/Documents/R_BioCond/Samples/sdfsample.sdf"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Miscellaneous accessor methods for <code class="highlighter-rouge">SDFset</code> container:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">header</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Not printed here
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">header</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##                             Molecule_Name                                    Source 
##                                  "650001"                  "  -OEChem-07071010512D" 
##                                   Comment                               Counts_Line 
##                                        "" " 61 64  0     0  0  0  0  0  0999 V2000"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">atomblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Not printed here 
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">atomblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##          C1     C2 C3 C5 C6 C7 C8 C9 C10 C11 C12 C13 C14 C15 C16
## O_1  7.0468 0.0839  0  0  0  0  0  0   0   0   0   0   0   0   0
## O_2 12.2708 1.0492  0  0  0  0  0  0   0   0   0   0   0   0   0
## O_3 12.2708 3.1186  0  0  0  0  0  0   0   0   0   0   0   0   0
## O_4  7.9128 2.5839  0  0  0  0  0  0   0   0   0   0   0   0   0
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">bondblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Not printed here 
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">bondblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   C1 C2 C3 C4 C5 C6 C7
## 1  1 16  2  0  0  0  0
## 2  2 23  1  0  0  0  0
## 3  2 27  1  0  0  0  0
## 4  3 25  1  0  0  0  0
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Not printed here 
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##           PUBCHEM_COMPOUND_CID PUBCHEM_COMPOUND_CANONICALIZED      PUBCHEM_CACTVS_COMPLEXITY 
##                       "650001"                            "1"                          "700" 
##  PUBCHEM_CACTVS_HBOND_ACCEPTOR 
##                            "7"
</code></pre>
</div>

<p>Assigning compound IDs and keeping them unique:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="c1"># Returns IDs from SDFset object
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] "CMP1" "CMP2" "CMP3" "CMP4"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="c1"># Returns IDs from SD file header block
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] "650001" "650002" "650003" "650004"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">unique_ids</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">makeUnique</span><span class="p">(</span><span class="n">sdfid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] "No duplicates detected!"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique_ids</span><span class="w"> 
</span></code></pre>
</div>

<p>Converting the data blocks in an <code class="highlighter-rouge">SDFset</code> to a matrix:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">blockmatrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">datablock2ma</span><span class="p">(</span><span class="n">datablocklist</span><span class="o">=</span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">))</span><span class="w"> </span><span class="c1"># Converts data block to matrix 
</span><span class="w"> </span><span class="n">numchar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">splitNumChar</span><span class="p">(</span><span class="n">blockmatrix</span><span class="o">=</span><span class="n">blockmatrix</span><span class="p">)</span><span class="w"> </span><span class="c1"># Splits to numeric and character matrix 
</span><span class="w"> </span><span class="n">numchar</span><span class="p">[[</span><span class="m">1</span><span class="p">]][</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="c1"># Slice of numeric matrix 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##        PUBCHEM_COMPOUND_CID PUBCHEM_COMPOUND_CANONICALIZED
## 650001               650001                              1
## 650002               650002                              1
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">numchar</span><span class="p">[[</span><span class="m">2</span><span class="p">]][</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="m">10</span><span class="o">:</span><span class="m">11</span><span class="p">]</span><span class="w"> </span><span class="c1"># Slice of character matrix 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##        PUBCHEM_MOLECULAR_FORMULA PUBCHEM_OPENEYE_CAN_SMILES                                     
## 650001 "C23H28N4O6"              "CC1=CC(=NO1)NC(=O)CCC(=O)N(CC(=O)NC2CCCC2)C3=CC4=C(C=C3)OCCO4"
## 650002 "C18H23N5O3"              "CN1C2=C(C(=O)NC1=O)N(C(=N2)NCCCO)CCCC3=CC=CC=C3"
</code></pre>
</div>

<p>Compute atom frequency matrix, molecular weight and formula:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">propma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">MF</span><span class="o">=</span><span class="n">MF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">),</span><span class="w"> </span><span class="n">MW</span><span class="o">=</span><span class="n">MW</span><span class="p">(</span><span class="n">sdfset</span><span class="p">),</span><span class="w"> </span><span class="n">atomcountMA</span><span class="p">(</span><span class="n">sdfset</span><span class="p">))</span><span class="w">
 </span><span class="n">propma</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##                 MF       MW  C  H N O S F Cl
## 650001  C23H28N4O6 456.4916 23 28 4 6 0 0  0
## 650002  C18H23N5O3 357.4069 18 23 5 3 0 0  0
## 650003 C18H18N4O3S 370.4255 18 18 4 3 1 0  0
## 650004 C21H27N5O5S 461.5346 21 27 5 5 1 0  0
</code></pre>
</div>

<p>Assign matrix data to data block:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">propma</span><span class="w"> 
 </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`650001`
##           MF           MW            C            H            N            O            S 
## "C23H28N4O6"   "456.4916"         "23"         "28"          "4"          "6"          "0" 
##            F           Cl 
##          "0"          "0"
</code></pre>
</div>

<p>String searching in <code class="highlighter-rouge">SDFset</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">grepSDFset</span><span class="p">(</span><span class="s2">"650001"</span><span class="p">,</span><span class="w"> </span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="o">=</span><span class="s2">"datablock"</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="s2">"subset"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Returns summary view of matches. Not printed here.
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">grepSDFset</span><span class="p">(</span><span class="s2">"650001"</span><span class="p">,</span><span class="w"> </span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="o">=</span><span class="s2">"datablock"</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="s2">"index"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 1 1 1 1 1 1 1 1 1 
## 1 2 3 4 5 6 7 8 9
</code></pre>
</div>

<p>Export SDFset to SD file:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">write.SDF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.sdf"</span><span class="p">,</span><span class="w"> </span><span class="n">sig</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Plot molecule structure of one or many SDFs:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="c1"># Plots structures to R graphics device 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/plotstruct-1.png" alt="" />\</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdf.visualize</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Compound viewing in web browser 
</span></code></pre>
</div>

<p><img src="visualizescreenshot-small.png" alt="Figure: Visualization webpage created by calling`sdf.visualize`." /></p>

<p>Structure similarity searching and clustering:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">apset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Generate atom pair descriptor database for searching 
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Load sample apset data provided by library. 
</span><span class="w"> </span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># Search apset database with single compound. 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   index    cid    scores
## 1     1 650001 1.0000000
## 2    96 650102 0.3516643
## 3    67 650072 0.3117569
## 4    88 650094 0.3094629
## 5    15 650015 0.3010753
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.65</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> </span><span class="c1"># Binning clustering using variable similarity cutoffs. 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## sorting result...
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##       ids CLSZ_0.65 CLID_0.65 CLSZ_0.5 CLID_0.5
## 48 650049         2        48        2       48
## 49 650050         2        48        2       48
## 54 650059         2        54        2       54
## 55 650060         2        54        2       54
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="openbabel-functions">OpenBabel Functions</h1>

<p><code class="highlighter-rouge">ChemmineR</code> integrates now a subset of cheminformatics
functionalities implemented in the OpenBabel C++ library [@greycite13432; @Cao_2008]. These
utilities can be accessed by installing the <code class="highlighter-rouge">ChemmineOB</code>
package and the OpenBabel software itself. <code class="highlighter-rouge">ChemmineR</code>
will automatically detect the availability of
<code class="highlighter-rouge">ChemmineOB</code> and make use of the additional utilities.
The following lists the functions and methods that make use of
OpenBabel. References are included to locate the sections in the manual
where the utility and usage of these functions is described.</p>

<p><em>Structure format interconversions</em> (see Section <a href="#format-interconversions">Format Inter-Conversions</a>)</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">smiles2sdf</code>: converts from SMILES to SDF object</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">sdf2smiles</code>: converts from SDF to SMILES object</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">convertFormat</code>: converts strings between two formats</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">convertFormatFile</code>: converts files between two formats. This function can be used to enable ChemmineR to read in any
format supported by Open Babel. For example, if you had an SML file you could do:</p>
  </li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">convertFormatFile</span><span class="p">(</span><span class="s2">"SML"</span><span class="p">,</span><span class="s2">"SDF"</span><span class="p">,</span><span class="s2">"mycompound.sml"</span><span class="p">,</span><span class="s2">"mycompound.sdf"</span><span class="p">)</span><span class="w">
</span><span class="n">sdfset</span><span class="o">=</span><span class="n">read.SDFset</span><span class="p">(</span><span class="s2">"mycompound.sdf"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><code class="highlighter-rouge">propOB</code>: generates several compound properties. See the man page for a current list of properties computed.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">propOB</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##                                                          cansmi
## 650001 O=C(Nc1noc(c1)C)CCC(=O)N(c1ccc2c(c1)OCCO2)CC(=O)NC1CCCC1
##                                                        cansmiNS    formula  title
## 650001 O=C(Nc1noc(c1)C)CCC(=O)N(c1ccc2c(c1)OCCO2)CC(=O)NC1CCCC1 C23H28N4O6 650001
##                                                                                                                                                                                    InChI
## 650001 InChI=1S/C23H28N4O6/c1-15-12-20(26-33-15)25-21(28)8-9-23(30)27(14-22(29)24-16-4-2-3-5-16)17-6-7-18-19(13-17)32-11-10-31-18/h6-7,12-13,16H,2-5,8-11,14H2,1H3,(H,24,29)(H,25,26,28)
##        HBA1 HBA2 HBD   logP       MR       MW nF TPSA
## 650001   37   10   2 3.0288 119.9234 456.4916  0  123
</code></pre>
</div>

<p><code class="highlighter-rouge">fingerprintOB</code>: generates fingerprints for compounds. The fingerprint name can be anything supported by OpenBabel. See the man page
for a current list.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">fingerprintOB</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="s2">"FP2"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 1024 bit "FPset" of type "FP2" with 100 molecules
</code></pre>
</div>

<p><code class="highlighter-rouge">smartsSearchOB</code>: find matches of SMARTS patterns in compounds</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1">#count rotable bonds
</span><span class="n">smartsSearchOB</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">],</span><span class="s2">"[!$(*#*)&amp;!D1]-!@[!$(*#*)&amp;!D1]"</span><span class="p">,</span><span class="n">uniqueMatches</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 650001 650002 650003 650004 650005 
##     24     20     14     30     10
</code></pre>
</div>

<p><code class="highlighter-rouge">exactMassOB</code>: Compute the monoisotopic (exact) mass of a set of compounds</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">exactMassOB</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">])</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   650001   650002   650003   650004   650005 
## 456.2009 357.1801 370.1100 461.1733 318.1943
</code></pre>
</div>

<p><code class="highlighter-rouge">regenerateCoords</code>: Re-compute the 2D coordinates of a compound using Open Babel. This can sometimes
improve the quality of the compounds plot. See also the <code class="highlighter-rouge">regenCoords</code> option of the plot function.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">sdfset2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">regenerateCoords</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">])</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">regenCoords</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/unnamed-chunk-30-1.png" alt="" />\</p>

<p><code class="highlighter-rouge">generate3DCoords</code>: Generate 3D coordinates for compounds with only 2D coordinates.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">sdf3D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generate3DCoords</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w">
</span></code></pre>
</div>

<p><code class="highlighter-rouge">canonicalize</code>: Compute a canonicalized atom numbering. This allows compounds with the same molecular
structure but different atom numberings to be compared properly.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">canonicalSdf</span><span class="o">=</span><span class="w"> </span><span class="n">canonicalize</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w">
</span></code></pre>
</div>

<p><code class="highlighter-rouge">canonicalNumbering</code>: Return a mapping from the original atom numbering to the 
canonical atom number.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">canonicalNumbering</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w">
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="overview-of-classes-and-functions">Overview of Classes and Functions</h1>

<p>The following list gives an overview of the most important S4 classes,
methods and functions available in the ChemmineR package. The help
documents of the package provide much more detailed information on each
utility. The standard R help documents for these utilities can be
accessed with this syntax: <code class="highlighter-rouge">?function\_name</code> (<em>e.g.</em>
<code class="highlighter-rouge">?cid</code>) and <code class="highlighter-rouge">?class\_name-class</code> (<em>e.g</em>.
<code class="highlighter-rouge">?"SDFset-class"</code>).</p>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="molecular-structure-data">Molecular Structure Data</h2>

<p>Classes</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">SDFstr</code>: intermediate string class to facilitate SD
file import; not important for end user</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">SDF</code>: container for single molecule imported from an
SD file</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">SDFset</code>: container for many SDF objects; most
important structure container for end user</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">SMI</code>: container for a single SMILES string</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">SMIset</code>: container for many SMILES strings</p>
  </li>
</ul>

<p>Functions/Methods (mainly for <code class="highlighter-rouge">SDFset</code> container,
<code class="highlighter-rouge">SMIset</code> should be coerced with
<code class="highlighter-rouge">smiles2sd</code> to <code class="highlighter-rouge">SDFset</code>)</p>

<ul>
  <li>
    <p>Accessor methods for <code class="highlighter-rouge">SDF/SDFset</code></p>

    <ul>
      <li>
        <p>Object slots: <code class="highlighter-rouge">cid</code>, <code class="highlighter-rouge">header</code>, <code class="highlighter-rouge">atomblock</code>, <code class="highlighter-rouge">bondblock</code>,
<code class="highlighter-rouge">datablock</code> (<code class="highlighter-rouge">sdfid</code>, <code class="highlighter-rouge">datablocktag</code>)</p>
      </li>
      <li>
        <p>Summary of <code class="highlighter-rouge">SDFset</code>: <code class="highlighter-rouge">view</code></p>
      </li>
      <li>
        <p>Matrix conversion of data block: <code class="highlighter-rouge">datablock2ma</code>,
<code class="highlighter-rouge">splitNumChar</code></p>
      </li>
      <li>
        <p>String search in SDFset: <code class="highlighter-rouge">grepSDFset</code></p>
      </li>
    </ul>
  </li>
  <li>
    <p>Coerce one class to another</p>

    <ul>
      <li>Standard syntax <code class="highlighter-rouge">as(..., "...")</code> works in most
cases. For details see R help with
   <code class="highlighter-rouge">?"SDFset-class"</code>.</li>
    </ul>
  </li>
  <li>
    <p>Utilities</p>

    <ul>
      <li>
        <p>Atom frequencies: <code class="highlighter-rouge">atomcountMA</code>, <code class="highlighter-rouge">atomcount</code></p>
      </li>
      <li>
        <p>Molecular weight: <code class="highlighter-rouge">MW</code></p>
      </li>
      <li>
        <p>Molecular formula: <code class="highlighter-rouge">MF</code></p>
      </li>
      <li>
        <p>…</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Compound structure depictions</p>

    <ul>
      <li>
        <p>R graphics device: <code class="highlighter-rouge">plot</code>, <code class="highlighter-rouge">plotStruc</code></p>
      </li>
      <li>
        <p>Online: <code class="highlighter-rouge">cmp.visualize</code></p>
      </li>
    </ul>
  </li>
</ul>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="structure-descriptor-data">Structure Descriptor Data</h2>

<p>Classes</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">AP</code>: container for atom pair descriptors of a single
molecule</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">APset</code>: container for many AP objects; most
important structure descriptor container for end user</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">FP</code>: container for fingerprint of a single molecule</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">FPset</code>: container for fingerprints of many
molecules, most important structure descriptor container for end
user</p>
  </li>
</ul>

<p>Functions/Methods</p>

<ul>
  <li>
    <p>Create <code class="highlighter-rouge">AP/APset</code> instances</p>

    <ul>
      <li>
        <p>From <code class="highlighter-rouge">SDFset</code>: <code class="highlighter-rouge">sdf2ap</code></p>
      </li>
      <li>
        <p>From SD file: <code class="highlighter-rouge">cmp.parse</code></p>
      </li>
      <li>
        <p>Summary of <code class="highlighter-rouge">AP/APset</code>: <code class="highlighter-rouge">view</code>,
<code class="highlighter-rouge">db.explain</code></p>
      </li>
    </ul>
  </li>
  <li>
    <p>Accessor methods for AP/APset</p>

    <ul>
      <li>Object slots: <code class="highlighter-rouge">ap</code>, <code class="highlighter-rouge">cid</code></li>
    </ul>
  </li>
  <li>
    <p>Coerce one class to another</p>

    <ul>
      <li>Standard syntax <code class="highlighter-rouge">as(..., "...")</code> works in most
cases. For details see R help with
<code class="highlighter-rouge">?"APset-class"</code>.</li>
    </ul>
  </li>
  <li>
    <p>Structure Similarity comparisons and Searching</p>

    <ul>
      <li>
        <p>Compute pairwise similarities : <code class="highlighter-rouge">cmp.similarity</code>,
<code class="highlighter-rouge">fpSim</code></p>
      </li>
      <li>
        <p>Search APset database: <code class="highlighter-rouge">cmp.search</code>, <code class="highlighter-rouge">fpSim</code></p>
      </li>
    </ul>
  </li>
  <li>
    <p>AP-based Structure Similarity Clustering</p>

    <ul>
      <li>
        <p>Single-linkage binning clustering: <code class="highlighter-rouge">cmp.cluster</code></p>
      </li>
      <li>
        <p>Visualize clustering result with MDS:
<code class="highlighter-rouge">cluster.visualize</code></p>
      </li>
      <li>
        <p>Size distribution of clusters: <code class="highlighter-rouge">cluster.sizestat</code></p>
      </li>
    </ul>
  </li>
  <li>
    <p>Folding</p>
    <ul>
      <li>Fold a descriptor with <code class="highlighter-rouge">fold</code></li>
      <li>Query the number of times a descriptor has been folded:
 <code class="highlighter-rouge">foldCount</code></li>
      <li>Query the number of bits in a descriptor: <code class="highlighter-rouge">numBits</code></li>
    </ul>
  </li>
</ul>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="import-of-compounds">Import of Compounds</h1>

<h2 id="sdf-import">SDF Import</h2>

<p>The following gives an overview of the most important import/export
functionalities for small molecules provided by
<code class="highlighter-rouge">ChemmineR</code>. The given example creates an instance of the
<code class="highlighter-rouge">SDFset</code> class using as sample data set the first 100
compounds from this PubChem SD file (SDF):
Compound_00650001_00675000.sdf.gz
(<a href="ftp://ftp.ncbi.nih.gov/pubchem/Compound/CURRENT-Full/SDF/">ftp://ftp.ncbi.nih.gov/pubchem/Compound/CURRENT-Full/SDF/</a>).</p>

<p>SDFs can be imported with the <code class="highlighter-rouge">read.SDFset</code> function:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.SDFset</span><span class="p">(</span><span class="s2">"http://faculty.ucr.edu/ tgirke/Documents/R_BioCond/Samples/sdfsample.sdf"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">sdfsample</span><span class="p">)</span><span class="w"> </span><span class="c1"># Loads the same SDFset provided by the library 
</span><span class="w"> </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfsample</span><span class="w">
 </span><span class="n">valid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">validSDF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Identifies invalid SDFs in SDFset objects 
</span><span class="w"> </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfset</span><span class="p">[</span><span class="n">valid</span><span class="p">]</span><span class="w"> </span><span class="c1"># Removes invalid SDFs, if there are any 
</span></code></pre>
</div>

<p>Import SD file into <code class="highlighter-rouge">SDFstr</code> container:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfstr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.SDFstr</span><span class="p">(</span><span class="s2">"http://faculty.ucr.edu/ tgirke/Documents/R_BioCond/Samples/sdfsample.sdf"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>
<p>Create
<code class="highlighter-rouge">SDFset</code> from <code class="highlighter-rouge">SDFstr</code> class:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfstr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="s2">"SDFstr"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">sdfstr</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "SDFstr" with 100 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfstr</span><span class="p">,</span><span class="w"> </span><span class="s2">"SDFset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "SDFset" with 100 molecules
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="smiles-import">SMILES Import</h2>

<p>The <code class="highlighter-rouge">read.SMIset</code> function imports one or many molecules
from a SMILES file and stores them in a <code class="highlighter-rouge">SMIset</code>
container. The input file is expected to contain one SMILES string per
row with tab-separated compound identifiers at the end of each line. The
compound identifiers are optional.</p>

<p>Create sample SMILES file and then import it:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">smisample</span><span class="p">);</span><span class="w"> </span><span class="n">smiset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">smisample</span><span class="w">
 </span><span class="n">write.SMI</span><span class="p">(</span><span class="n">smiset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.smi"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">smiset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.SMIset</span><span class="p">(</span><span class="s2">"sub.smi"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Inspect content of <code class="highlighter-rouge">SMIset</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">smisample</span><span class="p">)</span><span class="w"> </span><span class="c1"># Loads the same SMIset provided by the library 
</span><span class="w"> </span><span class="n">smiset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">smisample</span><span class="w">
 </span><span class="n">smiset</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "SMIset" with 100 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">smiset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`650001`
## An instance of "SMI"
## [1] "O=C(NC1CCCC1)CN(c1cc2OCCOc2cc1)C(=O)CCC(=O)Nc1noc(c1)C"
## 
## $`650002`
## An instance of "SMI"
## [1] "O=c1[nH]c(=O)n(c2nc(n(CCCc3ccccc3)c12)NCCCO)C"
</code></pre>
</div>

<p>Accessor functions:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">smiset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] "650001" "650002" "650003" "650004"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">smi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">smiset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">])</span><span class="w">
</span></code></pre>
</div>

<p>Create <code class="highlighter-rouge">SMIset</code> from named character vector:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">smi</span><span class="p">,</span><span class="w"> </span><span class="s2">"SMIset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "SMIset" with 2 molecules
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="export-of-compounds">Export of Compounds</h1>

<h2 id="sdf-export">SDF Export</h2>

<p>Write objects of classes <code class="highlighter-rouge">SDFset/SDFstr/SDF</code> to SD file:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">write.SDF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.sdf"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Writing customized <code class="highlighter-rouge">SDFset</code> to file containing
<code class="highlighter-rouge">ChemmineR</code> signature, IDs from <code class="highlighter-rouge">SDFset</code>
and no data block:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">write.SDF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.sdf"</span><span class="p">,</span><span class="w"> </span><span class="n">sig</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">cid</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">db</span><span class="o">=</span><span class="kc">NULL</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Example for injecting a custom matrix/data frame into the data block of
an <code class="highlighter-rouge">SDFset</code> and then writing it to an SD file:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">props</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">MF</span><span class="o">=</span><span class="n">MF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">),</span><span class="w"> </span><span class="n">MW</span><span class="o">=</span><span class="n">MW</span><span class="p">(</span><span class="n">sdfset</span><span class="p">),</span><span class="w"> </span><span class="n">atomcountMA</span><span class="p">(</span><span class="n">sdfset</span><span class="p">))</span><span class="w"> 
 </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">props</span><span class="w">
 </span><span class="n">write.SDF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.sdf"</span><span class="p">,</span><span class="w"> </span><span class="n">sig</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">cid</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Indirect export via <code class="highlighter-rouge">SDFstr</code> object:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdf2str</span><span class="p">(</span><span class="n">sdf</span><span class="o">=</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">sig</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">cid</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># Uses default components 
</span><span class="w"> </span><span class="n">sdf2str</span><span class="p">(</span><span class="n">sdf</span><span class="o">=</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">head</span><span class="o">=</span><span class="nb">letters</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">db</span><span class="o">=</span><span class="kc">NULL</span><span class="p">)</span><span class="w"> </span><span class="c1"># Uses custom components for header and data block 
</span></code></pre>
</div>

<p>Write <code class="highlighter-rouge">SDF</code>, <code class="highlighter-rouge">SDFset</code> or
<code class="highlighter-rouge">SDFstr</code> classes to file:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">write.SDF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.sdf"</span><span class="p">,</span><span class="w"> </span><span class="n">sig</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">cid</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">db</span><span class="o">=</span><span class="kc">NULL</span><span class="p">)</span><span class="w">
 </span><span class="n">write.SDF</span><span class="p">(</span><span class="n">sdfstr</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.sdf"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">cat</span><span class="p">(</span><span class="n">unlist</span><span class="p">(</span><span class="n">as</span><span class="p">(</span><span class="n">sdfstr</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)),</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.sdf"</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="smiles-export">SMILES Export</h2>

<p>Write objects of class <code class="highlighter-rouge">SMIset</code> to SMILES file with and
without compound identifiers:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">smisample</span><span class="p">);</span><span class="w"> </span><span class="n">smiset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">smisample</span><span class="w"> </span><span class="c1"># Sample data set 
</span><span class="w">
 </span><span class="n">write.SMI</span><span class="p">(</span><span class="n">smiset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.smi"</span><span class="p">,</span><span class="w"> </span><span class="n">cid</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="n">write.SMI</span><span class="p">(</span><span class="n">smiset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="s2">"sub.smi"</span><span class="p">,</span><span class="w"> </span><span class="n">cid</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="format-interconversions">Format Interconversions</h1>

<p>The <code class="highlighter-rouge">sdf2smiles</code> and <code class="highlighter-rouge">smiles2sdf</code>
functions provide format interconversion between SMILES strings
(Simplified Molecular Input Line Entry Specification) and
<code class="highlighter-rouge">SDFset</code> containers.</p>

<p>Convert an <code class="highlighter-rouge">SDFset</code> container to a SMILES
<code class="highlighter-rouge">character</code> string:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">sdfsample</span><span class="p">);</span><span class="w">
 </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfsample</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> 
 </span><span class="n">smiles</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdf2smiles</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> 
 </span><span class="n">smiles</span><span class="w"> 
</span></code></pre>
</div>

<p>Convert a SMILES <code class="highlighter-rouge">character</code> string to an
<code class="highlighter-rouge">SDFset</code> container:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">smiles2sdf</span><span class="p">(</span><span class="s2">"CC(=O)OC1=CC=CC=C1C(=O)O"</span><span class="p">)</span><span class="w">
 </span><span class="n">view</span><span class="p">(</span><span class="n">sdf</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>When the <code class="highlighter-rouge">ChemineOB</code> package is installed these
conversions are performed with the OpenBabel Open Source Chemistry
Toolbox. Otherwise the functions will fall back to using the ChemMine
Tools web service for this operation. The latter will require internet
connectivity and is limited to only the first compound given.
<code class="highlighter-rouge">ChemmineOB</code> provides access to the compound format
conversion functions of OpenBabel. Currently, over 160 formats are
supported by OpenBabel. The functions <code class="highlighter-rouge">convertFormat</code> and
<code class="highlighter-rouge">convertFormatFile</code> can be used to convert files or
strings between any two formats supported by OpenBabel. For example, to
convert a SMILES string to an SDF string, one can use the
<code class="highlighter-rouge">convertFormat</code> function.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfStr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">convertFormat</span><span class="p">(</span><span class="s2">"SMI"</span><span class="p">,</span><span class="s2">"SDF"</span><span class="p">,</span><span class="s2">"CC(=O)OC1=CC=CC=C1C(=O)O_name"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>This will return the given compound as an SDF formatted string. 2D
coordinates are also computed and included in the resulting SDF string.</p>

<p>To convert a file with compounds encoded in one format to another
format, the <code class="highlighter-rouge">convertFormatFile</code> function can be used
instead.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">convertFormatFile</span><span class="p">(</span><span class="s2">"SMI"</span><span class="p">,</span><span class="s2">"SDF"</span><span class="p">,</span><span class="s2">"test.smiles"</span><span class="p">,</span><span class="s2">"test.sdf"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>To see the whole list of file formats supported by OpenBabel, one can
run from the command-line “obabel -L formats”.</p>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="splitting-sd-files">Splitting SD Files</h1>

<p>The following <code class="highlighter-rouge">write.SDFsplit</code> function allows to split
SD Files into any number of smaller SD Files. This can become important
when working with very big SD Files. Users should note that this
function can output many files, thus one should run it in a dedicated
directory!</p>

<p>Create sample SD File with 100 molecules:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">write.SDF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="s2">"test.sdf"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Read in sample SD File. Note: reading file into SDFstr is much faster
than into SDFset:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfstr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.SDFstr</span><span class="p">(</span><span class="s2">"test.sdf"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Run export on <code class="highlighter-rouge">SDFstr</code> object:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">write.SDFsplit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sdfstr</span><span class="p">,</span><span class="w"> </span><span class="n">filetag</span><span class="o">=</span><span class="s2">"myfile"</span><span class="p">,</span><span class="w"> </span><span class="n">nmol</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="c1"># 'nmol' defines the number of molecules to write to each file 
</span></code></pre>
</div>

<p>Run export on <code class="highlighter-rouge">SDFset</code> object:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">write.SDFsplit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">filetag</span><span class="o">=</span><span class="s2">"myfile"</span><span class="p">,</span><span class="w"> </span><span class="n">nmol</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="streaming-through-large-sd-files">Streaming Through Large SD Files</h1>

<p>The <code class="highlighter-rouge">sdfStream</code> function allows to stream through SD
Files with millions of molecules without consuming much memory. During
this process any set of descriptors, supported by
<code class="highlighter-rouge">ChemmineR</code>, can be computed (<em>e.g.</em> atom pairs,
molecular properties, etc.), as long as they can be returned in tabular
format. In addition to descriptor values, the function returns a line
index that gives the start and end positions of each molecule in the
source SD File. This line index can be used by the downstream
<code class="highlighter-rouge">read.SDFindex</code> function to retrieve specific molecules
of interest from the source SD File without reading the entire file into
R. The following outlines the typical workflow of this streaming
functionality in <code class="highlighter-rouge">ChemmineR</code>.</p>

<p>Create sample SD File with 100 molecules:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">write.SDF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="s2">"test.sdf"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Define descriptor set in a simple function:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">desc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> 
 </span><span class="n">cbind</span><span class="p">(</span><span class="n">SDFID</span><span class="o">=</span><span class="n">sdfid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">),</span><span class="w"> 
	</span><span class="c1"># datablock2ma(datablocklist=datablock(sdfset)), 
</span><span class="w">	 </span><span class="n">MW</span><span class="o">=</span><span class="n">MW</span><span class="p">(</span><span class="n">sdfset</span><span class="p">),</span><span class="w">
	</span><span class="n">groups</span><span class="p">(</span><span class="n">sdfset</span><span class="p">),</span><span class="w"> </span><span class="n">APFP</span><span class="o">=</span><span class="n">desc2fp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">),</span><span class="w"> </span><span class="n">descnames</span><span class="o">=</span><span class="m">1024</span><span class="p">,</span><span class="w">
	</span><span class="n">type</span><span class="o">=</span><span class="s2">"character"</span><span class="p">),</span><span class="w"> </span><span class="n">AP</span><span class="o">=</span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"character"</span><span class="p">),</span><span class="w"> </span><span class="n">rings</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w">
	</span><span class="n">type</span><span class="o">=</span><span class="s2">"count"</span><span class="p">,</span><span class="w"> </span><span class="n">upper</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">arom</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">  
</span></code></pre>
</div>

<p>Run <code class="highlighter-rouge">sdfStream</code> with <code class="highlighter-rouge">desc</code> function and
write results to a file called <code class="highlighter-rouge">matrix.xls</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfStream</span><span class="p">(</span><span class="n">input</span><span class="o">=</span><span class="s2">"test.sdf"</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="o">=</span><span class="s2">"matrix.xls"</span><span class="p">,</span><span class="w"> </span><span class="n">fct</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span><span class="w"> </span><span class="n">Nlines</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="c1"># 'Nlines': number of lines to read from input SD File at a time 
</span></code></pre>
</div>

<p>One can also start reading from a specific line number in the SD file.
The following example starts at line number 950. This is useful for
restarting and debugging the process. With <code class="highlighter-rouge">append=TRUE</code>
the result can be appended to an existing file.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfStream</span><span class="p">(</span><span class="n">input</span><span class="o">=</span><span class="s2">"test.sdf"</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="o">=</span><span class="s2">"matrix2.xls"</span><span class="p">,</span><span class="w"> </span><span class="n">append</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">fct</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span><span class="w"> </span><span class="n">Nlines</span><span class="o">=</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">startline</span><span class="o">=</span><span class="m">950</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Select molecules meeting certain property criteria from SD File using
line index generated by previous <code class="highlighter-rouge">sdfStream</code> step:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">indexDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.delim</span><span class="p">(</span><span class="s2">"matrix.xls"</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="o">=</span><span class="m">1</span><span class="p">)[,</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> 
 </span><span class="n">indexDFsub</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">indexDF</span><span class="p">[</span><span class="n">indexDF</span><span class="o">$</span><span class="n">MW</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">400</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="c1"># Selects molecules with MW &lt; 400 
</span><span class="w"> </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.SDFindex</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"test.sdf"</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="o">=</span><span class="n">indexDFsub</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"SDFset"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Collects results in 'SDFset' container 
</span></code></pre>
</div>

<p>Write results directly to SD file without storing larger numbers of
molecules in memory:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">read.SDFindex</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"test.sdf"</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="o">=</span><span class="n">indexDFsub</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"file"</span><span class="p">,</span><span class="w">
 </span><span class="n">outfile</span><span class="o">=</span><span class="s2">"sub.sdf"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Read AP/APFP strings from file into <code class="highlighter-rouge">APset</code> or
<code class="highlighter-rouge">FP</code> object:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">apset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.AP</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"matrix.xls"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"ap"</span><span class="p">,</span><span class="w"> </span><span class="n">colid</span><span class="o">=</span><span class="s2">"AP"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">apfp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.AP</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"matrix.xls"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"fp"</span><span class="p">,</span><span class="w"> </span><span class="n">colid</span><span class="o">=</span><span class="s2">"APFP"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Alternatively, one can provide the AP/APFP strings in a named character
vector:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">apset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.AP</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"character"</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"ap"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpchar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">]),</span><span class="w"> </span><span class="n">descnames</span><span class="o">=</span><span class="m">1024</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"character"</span><span class="p">)</span><span class="w">
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">fpchar</span><span class="p">,</span><span class="w"> </span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="storing-compounds-in-an-sql-database">Storing Compounds in an SQL Database</h1>

<p>As an alternative to sdfStream, there is now also an option to store
data in an SQL database, which then allows for fast queries and compound
retrieval. The default database
is SQLite, but any other SQL database should work with some minor
modifications to the table definitions, which are stored in
schema/compounds.SQLite under the ChemmineR package directory. Compounds
are stored in their entirety in the databases so there is no need to
keep any original data files.</p>

<p>Users can define their own set of compound features to compute and store
when loading new compounds. Each of these features will be stored in its
own, indexed table. Searches can then be performed using these features
to quickly find specific compounds. Compounds can always be retrieved
quickly because of the database index, no need to scan a large compound
file. In addition to user defined features, descriptors can also be
computed and stored for each compound.</p>

<p>A new database can be created with the <code class="highlighter-rouge">initDb</code> function.
This takes either an existing database connection, or a filename. If a
filename is given then an SQLite database connection is created. It then
ensures that the required tables exist and creates them if not. The
connection object is then returned. This function can be called safely
on the same connection or database many times and will not delete any
data.</p>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="loading-data">Loading Data</h2>

<p>The functions <code class="highlighter-rouge">loadSdf</code> and <code class="highlighter-rouge">loadSmiles</code> can be used to load
compound data from either a file (both) or an <code class="highlighter-rouge">SDFset</code> (<code class="highlighter-rouge">loadSdf</code>
only).  The <code class="highlighter-rouge">fct</code> parameter should be a function to
extract features from the data. It will be handed an
<code class="highlighter-rouge">SDFset</code> generated from the data being loaded. This may
be done in batches, so there is no guarantee that the given SDFSset will
contain the whole dataset. This function should return a data frame with
a column for each feature and a row for each compound given. The order
of the final data frame should be the same as that of the
<code class="highlighter-rouge">SDFset</code>. The column names will become the feature names.
Each of these features will become a new, indexed, table in the database
which can be used later to search for compounds.</p>

<p>The <code class="highlighter-rouge">descriptors</code> parameter can be a function which
computes descriptors. This function will also be given an
<code class="highlighter-rouge">SDFset</code> object, which may be done in batches. It should
return a data frame with the following two columns: “descriptor” and
“descriptor_type”. The “descriptor” column should contain a string
representation of the descriptor, and “descriptor_type” is the type of
the descriptor. Our convention for atom pair is “ap” and “fp” for finger
print. The order should also be maintained.</p>

<p>When the data has been loaded, <code class="highlighter-rouge">loadSdf</code> will return the
compound id numbers of each compound loaded. These compound id numbers
are computed by the database and are not extracted from the compound
data itself. They can be used to quickly retrieve compounds later.</p>

<p>New features can also be added using this function. However, all
compounds must have all features so if new features are added to a new
set of compounds, all existing features must be computable by the
<code class="highlighter-rouge">fct</code> function given. If new features are detected, all
existing compounds will be run through <code class="highlighter-rouge">fct</code> in order to
compute the new features for them as well.</p>

<p>For example, if dataset X is loaded with features F1 and F2, and then at
a later time we load dataset Y with new feature F3, the
<code class="highlighter-rouge">fct</code> function used to load dataset Y must compute and
return features F1, F2, and F3. <code class="highlighter-rouge">loadSdf</code> will call
<code class="highlighter-rouge">fct</code> with both datasets X and Y so that all features are
available for all compounds. If any features are missing an error will
be raised. If just new features are being added, but no new compounds,
use the <code class="highlighter-rouge">addNewFeatures</code> function.</p>

<p>In this example, we create a new database called “test.db” and load it
with data from an <code class="highlighter-rouge">SDFset</code>. We also define
<code class="highlighter-rouge">fct</code> to compute the molecular weight, “MW”, and the
number of rings and aromatic rings. The rings function actually returns
a data frame with columns “RINGS” and “AROMATIC”, which will be merged
into the data frame being created which will also contain the “MW”
column. These will be the names used for these features and must be used
when searching with them. Finally, the new compound ids are returned and
stored in the “ids” variable.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">sdfsample</span><span class="p">)</span><span class="w">

 </span><span class="c1">#create and initialize a new SQLite database 
</span><span class="w"> </span><span class="n">conn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">initDb</span><span class="p">(</span><span class="s2">"test.db"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Loading required package: RSQLite
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Loading required package: DBI
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="c1"># load data and compute 3 features: molecular weight, with the MW function, 
</span><span class="w"> </span><span class="c1"># and counts for RINGS and AROMATIC, as computed by rings, which 
</span><span class="w"> </span><span class="c1"># returns a data frame itself. 
</span><span class="w"> </span><span class="n">ids</span><span class="o">&lt;-</span><span class="n">loadSdf</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">sdfsample</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> 
					 </span><span class="n">data.frame</span><span class="p">(</span><span class="n">rings</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s2">"count"</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">arom</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span><span class="n">propOB</span><span class="p">(</span><span class="n">sdfset</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> 

 </span><span class="c1">#list features in the database:
</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="n">listFeatures</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##  [1] "aromatic" "cansmi"   "cansmins" "formula"  "hba1"     "hba2"     "hbd"      "inchi"   
##  [9] "logp"     "mr"       "mw"       "nf"       "rings"    "title"    "tpsa"
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="updates">Updates</h2>
<p>By default the <code class="highlighter-rouge">loadSdf</code> / <code class="highlighter-rouge">loadSmiles</code> functions will detect duplicate
compound entries and only insert one of them. This means it is safe
to run these functions on the same data set several times and you
won’t end up with duplicates. This allows the functions to be re-run
in the event that a previous run on a dataset does not complete.
Duplicate compounds are detected by compouting the MD5 checksum on
the textual representation of it.</p>

<p>It can also update existing compounds with new versions of the same
compound. To enable this, set <code class="highlighter-rouge">updateByName</code> to true. It will then
consider two compounds with the same name to be the same, even if the
definition is different. Then, if the name of a compound exists in
the database and it is trying to insert another compound with the
same name, it will overwrite the existing compound. It will also drop
and re-compute all associated descriptors and features for the new
compound (assuming the required functions for descriptor and feature
computation are available at the time the update is performed).</p>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="duplicate-descriptors">Duplicate Descriptors</h2>
<p>It is often the case when loading a large set of compounds that
several compounds will produce the same descriptor. <code class="highlighter-rouge">ChemmineR</code> 
detects this case and only stores one copy of the descriptor for
every compound it is for. This feature saves some space and some
time for processes that need to be applied to every descriptor.
It also highlights a new problem. If you have a descriptor in hand
and you want to find a single compound to represent it, which
compound should be used if the descriptor was produced from multiple
compounds? To address this problem, <code class="highlighter-rouge">ChemmineR</code> allows you to set
priority values for each compound-descriptor mapping. Then, in
contexts where a single compound is required, the highest priority
compound will be chosen. Highest priority corresponds to the lowest
numerical value. So mapping with priority 0 would be used first.</p>

<p>To set these priorities there is the function <code class="highlighter-rouge">setPriorities</code>.
It takes a function, <code class="highlighter-rouge">priorityFn</code>, for computing these priority values.
The <code class="highlighter-rouge">setPriorities</code> function should be run after loading a complete set of data.
It will find each group of compounds which share the same
descriptor and call the given function, <code class="highlighter-rouge">priorityFn</code>, 
with the compound_id numbers of the group. This function should
then assign priorities to each compound-descriptor pair, however
it wishes.</p>

<p>One built in priority function is <code class="highlighter-rouge">forestSizePriorities</code>. This simply
prefers compounds with fewer disconnected components over compounds with
more dissconnected components.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">setPriorities</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">forestSizePriorities</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="searching">Searching</h2>

<p>Compounds can be searched for using the <code class="highlighter-rouge">findCompounds</code>
function. This function takes a connection object, a vector of feature
names used in the tests, and finally, a vector of tests that must all
pass for a compound to be included in the result set. Each test should
be a boolean expression. For example: <code class="highlighter-rouge">c("MW &lt;= 400","RINGS \&gt; 3")</code>
would return all compounds with a molecular weight of 400 or less and
more than 3 rings, assuming these features exist in the database. The
syntax for each test is <code class="highlighter-rouge">'\&lt;feature name\&gt; \&lt;SQL operator\&gt; \&lt;value\&gt;'</code>.
If you know SQL you can go beyond this basic syntax. These tests will
simply be concatenated together with “AND” in-between them and tacked on
the end of a WHERE clause of an SQL statement. So any SQL that will work
in that context is fine. The function will return a list of compound
ids, the actual compounds can be fetched with
<code class="highlighter-rouge">getCompounds</code>. If just the names are needed, the
<code class="highlighter-rouge">getCompoundNames</code> function can be used. Compounds can
also be fetched by name using the <code class="highlighter-rouge">findCompoundsByName</code>
function.</p>

<p>In this example we search for compounds with molecular weight less than
300.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findCompounds</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="s2">"mw"</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s2">"mw &lt; 300"</span><span class="p">))</span><span class="w">
</span><span class="n">message</span><span class="p">(</span><span class="s2">"found "</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">results</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## found 23
</code></pre>
</div>

<p>If more than one test is given, only compounds which satisfy all tests are found. So if we wanted
to further restrict our search to compounds with 2 or more aromatic rings we could do:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findCompounds</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s2">"mw"</span><span class="p">,</span><span class="s2">"aromatic"</span><span class="p">),</span><span class="nf">c</span><span class="p">(</span><span class="s2">"mw &lt; 300"</span><span class="p">,</span><span class="s2">"aromatic &gt;= 2"</span><span class="p">))</span><span class="w">
</span><span class="n">message</span><span class="p">(</span><span class="s2">"found "</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">results</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## found 9
</code></pre>
</div>

<p>Remember that any feature used in some test must be listed in the second argument.</p>

<p>String patterns can also be used. So if we wanted to match a substring of the molecular formula, say
to find compounds with 21 carbon atoms, we could do:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findCompounds</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="s2">"formula"</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s2">"formula like '%C21%'"</span><span class="p">))</span><span class="w">
</span><span class="n">message</span><span class="p">(</span><span class="s2">"found "</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">results</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## found 12
</code></pre>
</div>

<p>The “like” operator does a pattern match. There are two wildcard 
operators that can be used with this operator. The “%” will match any stretch of characters while the “?”
will match any single character. So the above expression would match a formula like “C21H28N4O6”.</p>

<p>Valid comparison operators are:</p>

<ul>
  <li>&lt;,    &lt;=,   &gt; ,   &gt;=</li>
  <li>=,    ==,   !=,   &lt;&gt;,   IS,   IS NOT,   IN,   LIKE</li>
</ul>

<p>The boolean operators “AND” and “OR” can also be used to create more complex expressions within a single test.</p>

<p>If you just want to fetch every compound in the database you can use the <code class="highlighter-rouge">getAllCompoundIds</code> function:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">allIds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAllCompoundIds</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span><span class="w">
</span><span class="n">message</span><span class="p">(</span><span class="s2">"found "</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">allIds</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## found 100
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="using-search-results">Using Search Results</h2>
<p>Once you have a list of compound ids from the <code class="highlighter-rouge">findCompounds</code> function, you can either
fetch the compound names, or the whole set of compounds as an SDFset.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1">#get the names of the compounds:
</span><span class="n">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCompoundNames</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">results</span><span class="p">)</span><span class="w">

</span><span class="c1">#if the name order is important set keepOrder=TRUE 
#It will take a little longer though
</span><span class="n">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCompoundNames</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">results</span><span class="p">,</span><span class="n">keepOrder</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 


</span><span class="c1"># get the whole set of compounds
</span><span class="n">compounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCompounds</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">results</span><span class="p">)</span><span class="w">
</span><span class="c1">#in order:
</span><span class="n">compounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCompounds</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">results</span><span class="p">,</span><span class="n">keepOrder</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="c1">#write results directly to a file:
</span><span class="n">compounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCompounds</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">results</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">file.path</span><span class="p">(</span><span class="n">tempdir</span><span class="p">(),</span><span class="s2">"results.sdf"</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<p>Using the <code class="highlighter-rouge">getCompoundFeatures</code> function, you can get a set of feature values 
as a data frame:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">getCompoundFeatures</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">],</span><span class="nf">c</span><span class="p">(</span><span class="s2">"mw"</span><span class="p">,</span><span class="s2">"logp"</span><span class="p">,</span><span class="s2">"formula"</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   compound_id       mw   logp       formula
## 1         204 461.5346 1.3127   C21H27N5O5S
## 2         208 438.4780 3.5492  C21H19FN6O2S
## 3         221 340.4592 3.1325    C21H28N2O2
## 4         238 447.9351 5.2940 C21H22ClN3O4S
## 5         243 456.5181 3.0020   C21H24N6O4S
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1">#write results directly to a CSV file (reduces memory usage):
</span><span class="n">getCompoundFeatures</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">],</span><span class="nf">c</span><span class="p">(</span><span class="s2">"mw"</span><span class="p">,</span><span class="s2">"logp"</span><span class="p">,</span><span class="s2">"formula"</span><span class="p">),</span><span class="n">filename</span><span class="o">=</span><span class="s2">"features.csv"</span><span class="p">)</span><span class="w">

</span><span class="c1">#maintain input order in output:
</span><span class="n">print</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">])</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 204 208 221 238 243
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">getCompoundFeatures</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">],</span><span class="nf">c</span><span class="p">(</span><span class="s2">"mw"</span><span class="p">,</span><span class="s2">"logp"</span><span class="p">,</span><span class="s2">"formula"</span><span class="p">),</span><span class="n">keepOrder</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     compound_id       mw   logp       formula
## 204         204 461.5346 1.3127   C21H27N5O5S
## 208         208 438.4780 3.5492  C21H19FN6O2S
## 221         221 340.4592 3.1325    C21H28N2O2
## 238         238 447.9351 5.2940 C21H22ClN3O4S
## 243         243 456.5181 3.0020   C21H24N6O4S
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="pre-built-databases">Pre-Built Databases</h2>
<p>We have pre-built SQLite databases for the Drug Bank and DUD datasets. They can be found in 
the ChemmineDrugs annotation package. Connections to these databases can be fetched from the
functions <code class="highlighter-rouge">DrugBank</code> and <code class="highlighter-rouge">DUD</code> to get the corresponding database. Any of the above functions can
then be used to query the database.</p>

<p>The DUD dataset was downloaded from <a href="http://dude.docking.org/db/subsets/all/all.tar.gz">here</a>. A description
can be found <a href="http://dude.docking.org/">here</a>.</p>

<p>The Drug Bank data set is version 4.1. It can be downloaded <a href="http://www.drugbank.ca/system/downloads/current/structures/all.sdf.zip">here</a></p>

<p>The following features are included:</p>

<ul>
  <li><strong>aromatic</strong>: Number of aromatic rings</li>
  <li><strong>cansmi</strong>: Canonical SMILES sting</li>
  <li><strong>cansmins</strong>:</li>
  <li><strong>formula</strong>: Molecular formula</li>
  <li><strong>hba1</strong>:</li>
  <li><strong>hba2</strong>:</li>
  <li><strong>hbd</strong>:</li>
  <li><strong>inchi</strong>: INCHI string</li>
  <li><strong>logp</strong>:</li>
  <li><strong>mr</strong>:</li>
  <li><strong>mw</strong>: Molecular weight</li>
  <li><strong>ncharges</strong>:</li>
  <li><strong>nf</strong>:</li>
  <li><strong>r2nh</strong>:</li>
  <li><strong>r3n</strong>:</li>
  <li><strong>rcch</strong>:</li>
  <li><strong>rcho</strong>:</li>
  <li><strong>rcn</strong>:</li>
  <li><strong>rcooh</strong>:</li>
  <li><strong>rcoor</strong>:</li>
  <li><strong>rcor</strong>:</li>
  <li><strong>rings</strong>:</li>
  <li><strong>rnh2</strong>:</li>
  <li><strong>roh</strong>:</li>
  <li><strong>ropo3</strong>:</li>
  <li><strong>ror</strong>:</li>
  <li><strong>title</strong>:</li>
  <li><strong>tpsa</strong>:</li>
</ul>

<p>The DUD database additionally includes:</p>

<ul>
  <li><strong>target_name</strong>: Name of the target</li>
  <li><strong>type</strong>: either “active” or “decoy”</li>
</ul>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="working-with-sdfsdfset-classes">Working with SDF/SDFset Classes</h1>

<p>Several methods are available to return the different data components of
<code class="highlighter-rouge">SDF/SDFset</code> containers in batches. The following
examples list the most important ones. To save space their content is
not printed in the manual.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Summary view of several molecules 
</span><span class="w">
 </span><span class="nf">length</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Returns number of molecules 
</span><span class="w"> </span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="w"> </span><span class="c1"># Returns single molecule from SDFset as SDF object 
</span><span class="w">
 </span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]][[</span><span class="m">2</span><span class="p">]]</span><span class="w"> </span><span class="c1"># Returns atom block from first compound as matrix
</span><span class="w">
 </span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]][[</span><span class="m">2</span><span class="p">]][</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> 
 </span><span class="nf">c</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">sdfset</span><span class="p">[</span><span class="m">5</span><span class="o">:</span><span class="m">8</span><span class="p">])</span><span class="w"> </span><span class="c1"># Concatenation of several SDFsets 
</span></code></pre>
</div>

<p>The <code class="highlighter-rouge">grepSDFset</code> function allows string
matching/searching on the different data components in
<code class="highlighter-rouge">SDFset</code>. By default the function returns a SDF summary
of the matching entries. Alternatively, an index of the matches can be
returned with the setting <code class="highlighter-rouge">mode="index"</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">grepSDFset</span><span class="p">(</span><span class="s2">"650001"</span><span class="p">,</span><span class="w"> </span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="o">=</span><span class="s2">"datablock"</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="s2">"subset"</span><span class="p">)</span><span class="w"> </span><span class="c1"># To return index, set mode="index") 
</span></code></pre>
</div>

<p>Utilities to maintain unique compound IDs:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Retrieves CMP IDs from Molecule Name field in header block. 
</span><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Retrieves CMP IDs from ID slot in SDFset. 
</span><span class="w"> </span><span class="n">unique_ids</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">makeUnique</span><span class="p">(</span><span class="n">sdfid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">))</span><span class="w"> </span><span class="c1"># Creates unique IDs by appending a counter to duplicates. 
</span><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique_ids</span><span class="w"> </span><span class="c1"># Assigns uniquified IDs to ID slot 
</span></code></pre>
</div>

<p>Subsetting by character, index and logical vectors:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s2">"650001"</span><span class="p">,</span><span class="w"> </span><span class="s2">"650012"</span><span class="p">)])</span><span class="w">
 </span><span class="n">view</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">4</span><span class="o">:</span><span class="m">1</span><span class="p">])</span><span class="w">
 </span><span class="n">mylog</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w">
 </span><span class="n">view</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="n">mylog</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<p>Accessing <code class="highlighter-rouge">SDF/SDFset</code> components: header, atom, bond and
data blocks:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">atomblock</span><span class="p">(</span><span class="n">sdf</span><span class="p">);</span><span class="w"> </span><span class="n">sdf</span><span class="p">[[</span><span class="m">2</span><span class="p">]];</span><span class="w">
 </span><span class="n">sdf</span><span class="p">[[</span><span class="s2">"atomblock"</span><span class="p">]]</span><span class="w"> </span><span class="c1"># All three methods return the same component
</span><span class="w">
 </span><span class="n">header</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> 
 </span><span class="n">atomblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">
 </span><span class="n">bondblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> 
 </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">  
 </span><span class="n">header</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])</span><span class="w">
 </span><span class="n">atomblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])</span><span class="w"> 
 </span><span class="n">bondblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])</span><span class="w"> 
 </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])</span><span class="w"> 
</span></code></pre>
</div>

<p>Replacement Methods:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]][[</span><span class="m">2</span><span class="p">]][</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">999</span><span class="w"> 
 </span><span class="n">atomblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">atomblock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)[</span><span class="m">2</span><span class="p">]</span><span class="w"> 
 </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)[</span><span class="m">2</span><span class="p">]</span><span class="w"> 
</span></code></pre>
</div>

<p>Assign matrix data to data block:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.matrix</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">,])</span><span class="w">
 </span><span class="n">view</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<p>Class coercions from <code class="highlighter-rouge">SDFstr</code> to <code class="highlighter-rouge">list</code>,
<code class="highlighter-rouge">SDF</code> and <code class="highlighter-rouge">SDFset</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfstr</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfstr</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="s2">"SDF"</span><span class="p">)</span><span class="w">
 </span><span class="n">as</span><span class="p">(</span><span class="n">sdfstr</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="s2">"SDFset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Class coercions from <code class="highlighter-rouge">SDF</code> to <code class="highlighter-rouge">SDFstr</code>,
<code class="highlighter-rouge">SDFset</code>, list with SDF sub-components:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdfcomplist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)</span><span class="w"> </span><span class="n">sdfcomplist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
 </span><span class="n">as</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="s2">"list"</span><span class="p">);</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfcomplist</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="s2">"SDF"</span><span class="p">)</span><span class="w"> </span><span class="n">sdflist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
 </span><span class="n">as</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="s2">"SDF"</span><span class="p">);</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdflist</span><span class="p">,</span><span class="w"> </span><span class="s2">"SDFset"</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="s2">"SDFstr"</span><span class="p">)</span><span class="w">
 </span><span class="n">as</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="s2">"SDFset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Class coercions from <code class="highlighter-rouge">SDFset</code> to lists with components
consisting of SDF or sub-components:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="s2">"SDF"</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="s2">"SDFstr"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="molecular-property-functions-physicochemical-descriptors">Molecular Property Functions (Physicochemical Descriptors)</h1>

<p>Several methods and functions are available to compute basic compound
descriptors, such as molecular formula (MF), molecular weight (MW), and
frequencies of atoms and functional groups. In many of these functions,
it is important to set <code class="highlighter-rouge">addH=TRUE</code> in order to
include/add hydrogens that are often not specified in an SD file.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">propma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">atomcountMA</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">addH</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
 </span><span class="n">boxplot</span><span class="p">(</span><span class="n">propma</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"Atom Frequency"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/boxplot-1.png" alt="" />\</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">boxplot</span><span class="p">(</span><span class="n">rowSums</span><span class="p">(</span><span class="n">propma</span><span class="p">),</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"All Atom Frequency"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Data frame provided by library containing atom names, atom symbols,
standard atomic weights, group and period numbers:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">atomprop</span><span class="p">)</span><span class="w">
 </span><span class="n">atomprop</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   Number      Name Symbol Atomic_weight Group Period
## 1      1  hydrogen      H      1.007940     1      1
## 2      2    helium     He      4.002602    18      1
## 3      3   lithium     Li      6.941000     1      2
## 4      4 beryllium     Be      9.012182     2      2
</code></pre>
</div>

<p>Compute MW and formula:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">MW</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">addH</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     CMP1     CMP2     CMP3     CMP4 
## 456.4916 357.4069 370.4255 461.5346
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">MF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">addH</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##          CMP1          CMP2          CMP3          CMP4 
##  "C23H28N4O6"  "C18H23N5O3" "C18H18N4O3S" "C21H27N5O5S"
</code></pre>
</div>

<p>Enumerate functional groups:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">groups</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">groups</span><span class="o">=</span><span class="s2">"fctgroup"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"countMA"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##      RNH2 R2NH R3N ROPO3 ROH RCHO RCOR RCOOH RCOOR ROR RCCH RCN
## CMP1    0    2   1     0   0    0    0     0     0   2    0   0
## CMP2    0    2   2     0   1    0    0     0     0   0    0   0
## CMP3    0    1   1     0   1    0    1     0     0   0    0   0
## CMP4    0    1   3     0   0    0    0     0     0   2    0   0
</code></pre>
</div>

<p>Combine MW, MF, charges, atom counts, functional group counts and ring
counts in one data frame:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">propma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">MF</span><span class="o">=</span><span class="n">MF</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">addH</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">),</span><span class="w"> </span><span class="n">MW</span><span class="o">=</span><span class="n">MW</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">addH</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
							 </span><span class="n">Ncharges</span><span class="o">=</span><span class="n">sapply</span><span class="p">(</span><span class="n">bonds</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"charge"</span><span class="p">),</span><span class="w"> </span><span class="n">length</span><span class="p">),</span><span class="w">
							 </span><span class="n">atomcountMA</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">addH</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">),</span><span class="w"> 
							 </span><span class="n">groups</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"countMA"</span><span class="p">),</span><span class="w"> 
							 </span><span class="n">rings</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">upper</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"count"</span><span class="p">,</span><span class="w"> </span><span class="n">arom</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span><span class="w">
 </span><span class="n">propma</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##               MF       MW Ncharges  C  H N O S F Cl RNH2 R2NH R3N ROPO3 ROH RCHO RCOR RCOOH RCOOR
## CMP1  C23H28N4O6 456.4916        0 23 28 4 6 0 0  0    0    2   1     0   0    0    0     0     0
## CMP2  C18H23N5O3 357.4069        0 18 23 5 3 0 0  0    0    2   2     0   1    0    0     0     0
## CMP3 C18H18N4O3S 370.4255        0 18 18 4 3 1 0  0    0    1   1     0   1    0    1     0     0
## CMP4 C21H27N5O5S 461.5346        0 21 27 5 5 1 0  0    0    1   3     0   0    0    0     0     0
##      ROR RCCH RCN RINGS AROMATIC
## CMP1   2    0   0     4        2
## CMP2   0    0   0     3        3
## CMP3   0    0   0     4        2
## CMP4   2    0   0     3        3
</code></pre>
</div>

<p>The following shows an example for assigning the values stored in a
matrix (<em>e.g.</em> property descriptors) to the data block components in an
<code class="highlighter-rouge">SDFset</code>. Each matrix row will be assigned to the
corresponding slot position in the <code class="highlighter-rouge">SDFset</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">propma</span><span class="w"> </span><span class="c1"># Works with all SDF components 
</span><span class="w"> </span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> 
 </span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">propma</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,],</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> 
 </span><span class="n">data.frame</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="n">colnames</span><span class="p">(</span><span class="n">propma</span><span class="p">),</span><span class="w"> </span><span class="n">value</span><span class="o">=</span><span class="n">x</span><span class="p">))</span><span class="w"> 
</span></code></pre>
</div>

<p>The data blocks in SDFs contain often important annotation information
about compounds. The <code class="highlighter-rouge">datablock2ma</code> function returns this
information as matrix for all compounds stored in an
<code class="highlighter-rouge">SDFset</code> container. The <code class="highlighter-rouge">splitNumChar</code>
function can then be used to organize all numeric columns in a
<code class="highlighter-rouge">numeric matrix</code> and the character columns in a
<code class="highlighter-rouge">character matrix</code> as components of a
<code class="highlighter-rouge">list</code> object.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">datablocktag</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="o">=</span><span class="s2">"PUBCHEM_NIST_INCHI"</span><span class="p">)</span><span class="w">
 </span><span class="n">datablocktag</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w">
 </span><span class="n">tag</span><span class="o">=</span><span class="s2">"PUBCHEM_OPENEYE_CAN_SMILES"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Convert entire data block to matrix:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">blockmatrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">datablock2ma</span><span class="p">(</span><span class="n">datablocklist</span><span class="o">=</span><span class="n">datablock</span><span class="p">(</span><span class="n">sdfset</span><span class="p">))</span><span class="w"> </span><span class="c1"># Converts data block to matrix 
</span><span class="w"> </span><span class="n">numchar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">splitNumChar</span><span class="p">(</span><span class="n">blockmatrix</span><span class="o">=</span><span class="n">blockmatrix</span><span class="p">)</span><span class="w"> </span><span class="c1"># Splits matrix to numeric matrix and character matrix 
</span><span class="w"> </span><span class="n">numchar</span><span class="p">[[</span><span class="m">1</span><span class="p">]][</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,];</span><span class="w"> </span><span class="n">numchar</span><span class="p">[[</span><span class="m">2</span><span class="p">]][</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w">
 </span><span class="c1"># Splits matrix to numeric matrix and character matrix 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="bond-matrices">Bond Matrices</h1>

<p>Bond matrices provide an efficient data structure for many basic
computations on small molecules. The function <code class="highlighter-rouge">conMA</code>
creates this data structure from <code class="highlighter-rouge">SDF</code> and
<code class="highlighter-rouge">SDFset</code> objects. The resulting bond matrix contains the
atom labels in the row/column titles and the bond types in the data
part. The labels are defined as follows: 0 is no connection, 1 is a
single bond, 2 is a double bond and 3 is a triple bond.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">conMA</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w">
 </span><span class="n">exclude</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"H"</span><span class="p">))</span><span class="w"> </span><span class="c1"># Create bond matrix for first two molecules in sdfset
</span><span class="w">
 </span><span class="n">conMA</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">exclude</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"H"</span><span class="p">))</span><span class="w"> </span><span class="c1"># Return bond matrix for first molecule 
</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">atomnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">noHbonds</span><span class="o">=</span><span class="kc">FALSE</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">no_print_atoms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">atomcex</span><span class="o">=</span><span class="m">0.8</span><span class="p">)</span><span class="w"> </span><span class="c1"># Plot its structure with atom numbering 
</span><span class="w"> </span><span class="n">rowSums</span><span class="p">(</span><span class="n">conMA</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">exclude</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"H"</span><span class="p">)))</span><span class="w"> </span><span class="c1"># Return number of non-H bonds for each atom
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="charges-and-missing-hydrogens">Charges and Missing Hydrogens</h1>

<p>The function <code class="highlighter-rouge">bonds</code> returns information about the number
of bonds, charges and missing hydrogens in <code class="highlighter-rouge">SDF</code> and
<code class="highlighter-rouge">SDFset</code> objects. It is used by many other functions
(<em>e.g.</em> <code class="highlighter-rouge">MW</code>, <code class="highlighter-rouge">MF</code>,
<code class="highlighter-rouge">atomcount</code>, <code class="highlighter-rouge">atomcuntMA</code> and
<code class="highlighter-rouge">plot</code>) to correct for missing hydrogens that are often
not specified in SD files.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">bonds</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"bonds"</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   atom Nbondcount Nbondrule charge
## 1    O          2         2      0
## 2    O          2         2      0
## 3    O          2         2      0
## 4    O          2         2      0
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">bonds</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"charge"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $CMP1
## NULL
## 
## $CMP2
## NULL
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">bonds</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"addNH"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## CMP1 CMP2 
##    0    0
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="ring-perception-and-aromaticity-assignment">Ring Perception and Aromaticity Assignment</h1>

<p>The function <code class="highlighter-rouge">rings</code> identifies all possible rings in one
or many molecules (here <code class="highlighter-rouge">sdfset[1]</code>) using the exhaustive
ring perception algorithm from Hanser et al. [-@Hanser_1996]. In addition, the function can 
return all smallest possible rings as well as aromaticity information.</p>

<p>The following example returns all possible rings in a
<code class="highlighter-rouge">list</code>. The argument <code class="highlighter-rouge">upper</code> allows to
specify an upper length limit for rings. Choosing smaller length limits
will reduce the search space resulting in shortened compute times. Note:
each ring is represented by a character vector of atom symbols that are
numbered by their position in the atom block of the corresponding
<code class="highlighter-rouge">SDF/SDFset</code> object.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">ringatoms</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rings</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">upper</span><span class="o">=</span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"all"</span><span class="p">,</span><span class="w"> </span><span class="n">arom</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">inner</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>For visual inspection, the corresponding compound structure can be
plotted with the ring bonds highlighted in color:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">atomindex</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">gsub</span><span class="p">(</span><span class="s2">".*_"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">unlist</span><span class="p">(</span><span class="n">ringatoms</span><span class="p">))))</span><span class="w">
 </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">colbonds</span><span class="o">=</span><span class="n">atomindex</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/unnamed-chunk-90-1.png" alt="" />\</p>

<p>Alternatively, one can include the atom numbers in the plot:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">atomnum</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">no_print_atoms</span><span class="o">=</span><span class="s2">"H"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/unnamed-chunk-91-1.png" alt="" />\</p>

<p>Aromaticity information of the rings can be returned in a logical vector
by setting <code class="highlighter-rouge">arom=TRUE</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">rings</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">upper</span><span class="o">=</span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"all"</span><span class="p">,</span><span class="w"> </span><span class="n">arom</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">inner</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $RINGS
## $RINGS$ring1
## [1] "N_10" "O_6"  "C_32" "C_31" "C_30"
## 
## $RINGS$ring2
## [1] "C_12" "C_14" "C_15" "C_13" "C_11"
## 
## $RINGS$ring3
## [1] "C_23" "O_2"  "C_27" "C_28" "O_3"  "C_25"
## 
## $RINGS$ring4
## [1] "C_23" "C_21" "C_18" "C_22" "C_26" "C_25"
## 
## $RINGS$ring5
##  [1] "O_3"  "C_28" "C_27" "O_2"  "C_23" "C_21" "C_18" "C_22" "C_26" "C_25"
## 
## 
## $AROMATIC
## ring1 ring2 ring3 ring4 ring5 
##  TRUE FALSE FALSE  TRUE FALSE
</code></pre>
</div>

<p>Return rings with no more than 6 atoms that are also aromatic:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">rings</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">upper</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"arom"</span><span class="p">,</span><span class="w"> </span><span class="n">arom</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">inner</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $AROMATIC_RINGS
## $AROMATIC_RINGS$ring1
## [1] "N_10" "O_6"  "C_32" "C_31" "C_30"
## 
## $AROMATIC_RINGS$ring4
## [1] "C_23" "C_21" "C_18" "C_22" "C_26" "C_25"
</code></pre>
</div>

<p>Count shortest possible rings and their aromaticity assignments by
setting <code class="highlighter-rouge">type=count</code> and <code class="highlighter-rouge">inner=TRUE</code>. The
inner (smallest possible) rings are identified by first computing all
possible rings and then selecting only the inner rings. For more
details, consult the help documentation with <code class="highlighter-rouge">?rings</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">rings</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">upper</span><span class="o">=</span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"count"</span><span class="p">,</span><span class="w"> </span><span class="n">arom</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">inner</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##      RINGS AROMATIC
## CMP1     4        2
## CMP2     3        3
## CMP3     4        2
## CMP4     3        3
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="rendering-chemical-structure-images">Rendering Chemical Structure Images</h1>

<h2 id="r-graphics-device">R Graphics Device</h2>

<p>A new plotting function for compound structures has been added to the
package recently. This function uses the native R graphics device for
generating compound depictions. At this point this function is still in
an experimental developmental stage but should become stable soon.</p>

<p>If you have <code class="highlighter-rouge">ChemmineOB</code> available you can use the <code class="highlighter-rouge">regenCoords</code>
option to have OpenBabel regenerate the coordinates for the compound.
This can sometimes produce better looking plots.</p>

<p>Plot compound Structures with R’s graphics device:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">sdfsample</span><span class="p">)</span><span class="w">
 </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfsample</span><span class="w">
 </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">regenCoords</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="c1"># 'print=TRUE' returns SDF summaries
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/plotstruct2-1.png" alt="" />\</p>

<p>Customized plots:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">griddim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">print_cid</span><span class="o">=</span><span class="nb">letters</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> 
		</span><span class="n">noHbonds</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>In the following plot, the atom block position numbers in the SDF are
printed next to the atom symbols (<code class="highlighter-rouge">atomnum = TRUE</code>). For
more details, consult help documentation with
<code class="highlighter-rouge">?plotStruc</code> or <code class="highlighter-rouge">?plot</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="s2">"CMP1"</span><span class="p">],</span><span class="w"> </span><span class="n">atomnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">noHbonds</span><span class="o">=</span><span class="nb">F</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">no_print_atoms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
	  	</span><span class="n">atomcex</span><span class="o">=</span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="o">=</span><span class="n">paste</span><span class="p">(</span><span class="s2">"MW:"</span><span class="p">,</span><span class="w"> </span><span class="n">MW</span><span class="p">(</span><span class="n">sdfsample</span><span class="p">[</span><span class="s2">"CMP1"</span><span class="p">])),</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/plotstruct3-1.png" alt="" />\</p>

<p>Substructure highlighting by atom numbers:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">colbonds</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">22</span><span class="p">,</span><span class="m">26</span><span class="p">,</span><span class="m">25</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">28</span><span class="p">,</span><span class="m">27</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">23</span><span class="p">,</span><span class="m">21</span><span class="p">,</span><span class="m">18</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">19</span><span class="p">,</span><span class="m">20</span><span class="p">,</span><span class="m">24</span><span class="p">))</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/plotstruct4-1.png" alt="" />\</p>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="online-with-chemmine-tools">Online with ChemMine Tools</h2>

<p>Alternatively, one can visualize compound structures with a standard web
browser using the online ChemMine Tools service.</p>

<p>Plot structures using web service ChemMine Tools:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sdf.visualize</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="visualizescreenshot-small.png" alt="Figure: Visualization webpage created by calling `sdf.visualize`." /></p>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="similarity-comparisons-and-searching">Similarity Comparisons and Searching</h1>

<h2 id="maximum-common-substructure-mcs-searching">Maximum Common Substructure (MCS) Searching</h2>

<p>The <code class="highlighter-rouge">ChemmineR</code> add-on package
<a href="http://www.bioconductor.org/packages/devel/bioc/html/fmcsR.html"><code class="highlighter-rouge">fmcsR</code></a>
provides support for identifying maximum common substructures (MCSs) and
flexible MCSs among compounds. The algorithm can be used for pairwise
compound comparisons, structure similarity searching and clustering. The
manual describing this functionality is available
<a href="http://www.bioconductor.org/packages/devel/bioc/vignettes/fmcsR/inst/doc/fmcsR.html">here</a>
and the associated publication is Wang et al. [-@Wang_2013]. The following gives a
short preview of some functionalities provided by the
<code class="highlighter-rouge">fmcsR</code> package.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">fmcsR</span><span class="p">)</span><span class="w">
 </span><span class="n">data</span><span class="p">(</span><span class="n">fmcstest</span><span class="p">)</span><span class="w"> </span><span class="c1"># Loads test sdfset object 
</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fmcs</span><span class="p">(</span><span class="n">fmcstest</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fmcstest</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">au</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">bu</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># Searches for MCS with mismatches 
</span><span class="w"> </span><span class="n">plotMCS</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="w"> </span><span class="c1"># Plots both query compounds with MCS in color 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/plotmcs-1.png" alt="" />\</p>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="apapset-classes-for-storing-atom-pair-descriptors">AP/APset Classes for Storing Atom Pair Descriptors</h2>

<p>The function <code class="highlighter-rouge">sdf2ap</code> computes atom pair descriptors for
one or many compounds [@Carhart_1985; @Chen_2002]. It returns a searchable atom pair database
stored in a container of class <code class="highlighter-rouge">APset</code>, which can be used
for structural similarity searching and clustering. As similarity
measure, the Tanimoto coefficient or related coefficients can be used.
An <code class="highlighter-rouge">APset</code> object consists of one or many
<code class="highlighter-rouge">AP</code> entries each storing the atom pairs of a single
compound. Note: the deprecated <code class="highlighter-rouge">cmp.parse</code> function is
still available which also generates atom pair descriptor databases, but
directly from an SD file. Since the latter function is less flexible it
may be discontinued in the future.</p>

<p>Generate atom pair descriptor database for searching:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">ap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])</span><span class="w"> </span><span class="c1"># For single compound
</span><span class="w"> </span><span class="n">ap</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 52614450304 52615497856 52615514112 52616547456 52616554624 ... length: 528
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">apset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w">
 </span><span class="c1"># For many compounds. 
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">view</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`650001`
## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 53688190976 53688190977 53688190978 53688190979 53688190980 ... length: 528 
## 
## $`650002`
## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 53688190976 53688190977 53688190978 53688190979 53689239552 ... length: 325 
## 
## $`650003`
## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 52615496704 53688190976 53688190977 53689239552 53697627136 ... length: 325 
## 
## $`650004`
## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 52617593856 52618642432 52619691008 52619691009 52628079616 ... length: 496
</code></pre>
</div>

<p>Return main components of APset objects:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Compound IDs 
</span><span class="w"> </span><span class="n">ap</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Atom pair
</span><span class="w"> </span><span class="n">descriptors</span><span class="w"> 
 </span><span class="n">db.explain</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="c1"># Return atom pairs in human readable format 
</span></code></pre>
</div>

<p>Coerce APset to other objects:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">apset2descdb</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Returns old list-style AP database 
</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Returns list 
</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="s2">"APset"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Converts list back to APset 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="large-sdf-and-atom-pair-databases">Large SDF and Atom Pair Databases</h2>

<p>When working with large data sets it is often desirable to save the
<code class="highlighter-rouge">SDFset</code> and <code class="highlighter-rouge">APset</code> containers as binary
R objects to files for later use. This way they can be loaded very
quickly into a new R session without recreating them every time from
scratch.</p>

<p>Save and load of <code class="highlighter-rouge">SDFset</code> and <code class="highlighter-rouge">APset</code>
containers:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sdfset.rda"</span><span class="p">,</span><span class="w"> </span><span class="n">compress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
 </span><span class="n">load</span><span class="p">(</span><span class="s2">"sdfset.rda"</span><span class="p">)</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"apset.rda"</span><span class="p">,</span><span class="w"> </span><span class="n">compress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
 </span><span class="n">load</span><span class="p">(</span><span class="s2">"apset.rda"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="pairwise-compound-comparisons-with-atom-pairs">Pairwise Compound Comparisons with Atom Pairs</h2>

<p>The <code class="highlighter-rouge">cmp.similarity</code> function computes the atom pair
similarity between two compounds using the Tanimoto coefficient as
similarity measure. The coefficient is defined as <em>c/(a+b+c)</em>, which
is the proportion of the atom pairs shared among two compounds divided
by their union. The variable <em>c</em> is the number of atom pairs common in
both compounds, while <em>a</em> and <em>b</em> are the numbers of their unique
atom pairs.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.similarity</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w">
 </span><span class="n">apset</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 0.2637037
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.similarity</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="similarity-searching-with-atom-pairs">Similarity Searching with Atom Pairs</h2>

<p>The <code class="highlighter-rouge">cmp.search</code> function searches an atom pair database
for compounds that are similar to a query compound. The following
example returns a data frame where the rows are sorted by the Tanimoto
similarity score (best to worst). The first column contains the indices
of the matching compounds in the database. The argument cutoff can be a
similarity cutoff, meaning only compounds with a similarity value larger
than this cutoff will be returned; or it can be an integer value
restricting how many compounds will be returned. When supplying a cutoff
of 0, the function will return the similarity values for every compound
in the database.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w">
 </span><span class="n">apset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   index    cid    scores
## 1    61 650066 1.0000000
## 2    60 650065 1.0000000
## 3    67 650072 0.3389831
## 4    11 650011 0.3190608
## 5    15 650015 0.3184524
## 6    86 650092 0.3154270
## 7    64 650069 0.3010279
</code></pre>
</div>
<p>Alternatively, the
function can return the matches in form of an index or a named vector if
the <code class="highlighter-rouge">type</code> argument is set to <code class="highlighter-rouge">1</code> or
<code class="highlighter-rouge">2</code>, respectively.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 61 60 67 11 15 86 64
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##    650066    650065    650072    650011    650015    650092    650069 
## 1.0000000 1.0000000 0.3389831 0.3190608 0.3184524 0.3154270 0.3010279
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="fpfpset-classes-for-storing-fingerprints">FP/FPset Classes for Storing Fingerprints</h2>

<p>The <code class="highlighter-rouge">FPset</code> class stores fingerprints of small molecules
in a matrix-like representation where every molecule is encoded as a
fingerprint of the same type and length. The <code class="highlighter-rouge">FPset</code>
container acts as a searchable database that contains the fingerprints
of many molecules. The <code class="highlighter-rouge">FP</code> container holds only one
fingerprint. Several constructor and coerce methods are provided to
populate <code class="highlighter-rouge">FP/FPset</code> containers with fingerprints, while
supporting any type and length of fingerprints. For instance, the
function <code class="highlighter-rouge">desc2fp</code> generates fingerprints from an atom
pair database stored in an <code class="highlighter-rouge">APset</code>, and
<code class="highlighter-rouge">as(matrix, "FPset")</code> and <code class="highlighter-rouge">as(character, "FPset")</code> construct an <code class="highlighter-rouge">FPset</code> database from
objects where the fingerprints are represented as
<code class="highlighter-rouge">matrix</code> or <code class="highlighter-rouge">character</code> objects,
respectively.</p>

<p>Show slots of <code class="highlighter-rouge">FPset</code> class:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">showClass</span><span class="p">(</span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Class "FPset" [package "ChemmineR"]
## 
## Slots:
##                                     
## Name:       fpma      type foldCount
## Class:    matrix character   numeric
</code></pre>
</div>

<p>Instance of <code class="highlighter-rouge">FPset</code> class:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w">
 </span><span class="n">view</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`650001`
## An instance of "FP" of type "unknown-4721"
## &lt;&lt;fingerprint&gt;&gt;
## 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... length: 1024 
## 
## $`650002`
## An instance of "FP" of type "unknown-4173"
## &lt;&lt;fingerprint&gt;&gt;
## 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 0 0 0 1 1 ... length: 1024
</code></pre>
</div>

<p><code class="highlighter-rouge">FPset</code> class usage:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="c1"># behaves like a list 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 1024 bit "FPset" of type "apfp" with 4 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="w"> </span><span class="c1"># returns FP object 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "FP" of type "unknown-2986"
## &lt;&lt;fingerprint&gt;&gt;
## 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... length: 1024
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># number of compounds ENDCOMMENT
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 100
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># returns compound ids 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   [1] "650001" "650002" "650003" "650004" "650005" "650006" "650007" "650008" "650009" "650010"
##  [11] "650011" "650012" "650013" "650014" "650015" "650016" "650017" "650019" "650020" "650021"
##  [21] "650022" "650023" "650024" "650025" "650026" "650027" "650028" "650029" "650030" "650031"
##  [31] "650032" "650033" "650034" "650035" "650036" "650037" "650038" "650039" "650040" "650041"
##  [41] "650042" "650043" "650044" "650045" "650046" "650047" "650048" "650049" "650050" "650052"
##  [51] "650054" "650056" "650058" "650059" "650060" "650061" "650062" "650063" "650064" "650065"
##  [61] "650066" "650067" "650068" "650069" "650070" "650071" "650072" "650073" "650074" "650075"
##  [71] "650076" "650077" "650078" "650079" "650080" "650081" "650082" "650083" "650085" "650086"
##  [81] "650087" "650088" "650089" "650090" "650091" "650092" "650093" "650094" "650095" "650096"
##  [91] "650097" "650098" "650099" "650100" "650101" "650102" "650103" "650104" "650105" "650106"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="p">[</span><span class="m">10</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c1"># replacement of 10th fingerprint to all zeros 
</span><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># replaces compound ids 
</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">[</span><span class="m">11</span><span class="o">:</span><span class="m">14</span><span class="p">])</span><span class="w"> </span><span class="c1"># concatenation of several FPset objects 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 1024 bit "FPset" of type "apfp" with 8 molecules
</code></pre>
</div>

<p>Construct <code class="highlighter-rouge">FPset</code> class form <code class="highlighter-rouge">matrix</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.matrix</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># coerces FPset to matrix 
</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">fpma</span><span class="p">,</span><span class="w"> </span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 1024 bit "FPset" of type "unknown-6312" with 100 molecules
</code></pre>
</div>

<p>Construct <code class="highlighter-rouge">FPset</code> class form <code class="highlighter-rouge">character vector</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpchar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># coerces FPset to character strings 
</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">fpchar</span><span class="p">,</span><span class="w"> </span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> </span><span class="c1"># construction of FPset class from character vector
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 1024 bit "FPset" of type "apfp" with 100 molecules
</code></pre>
</div>

<p>Compound similarity searching with <code class="highlighter-rouge">FPset</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.4</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="o">=</span><span class="m">4</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##         1        96        67        15 
## 1.0000000 0.4719101 0.4288499 0.4275229
</code></pre>
</div>

<p>Folding fingerprints:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># fold each FP once
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 512 bit "FPset" of type "apfp" with 100 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1">#fold each FP twice
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 256 bit "FPset" of type "apfp" with 100 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">bits</span><span class="o">=</span><span class="m">128</span><span class="p">)</span><span class="w"> </span><span class="c1">#fold each FP down to 128 bits
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 128 bit "FPset" of type "apfp" with 100 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])</span><span class="w">  </span><span class="c1"># fold an individual FP
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "FP" of type "unknown-2996"
## &lt;&lt;fingerprint&gt;&gt;
## 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... length: 512
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fptype</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># get type of FPs
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] "apfp"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">numBits</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># get the number of bits of each FP
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1024
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">foldCount</span><span class="p">(</span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">))</span><span class="w"> </span><span class="c1"># the number of times an FP or FPset has been folded
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="atom-pair-fingerprints">Atom Pair Fingerprints</h2>

<p>Atom pairs can be converted into binary atom pair fingerprints of fixed
length. Computations on this compact data structure are more time and
memory efficient than on their relatively complex atom pair
counterparts. The function <code class="highlighter-rouge">desc2fp</code> generates
fingerprints from descriptor vectors of variable length such as atom
pairs stored in <code class="highlighter-rouge">APset</code> or <code class="highlighter-rouge">list</code>
containers. The obtained fingerprints can be used for structure
similarity comparisons, searching and clustering.</p>

<p>Create atom pair sample data set:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">sdfsample</span><span class="p">)</span><span class="w">
 </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfsample</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">]</span><span class="w"> 
 </span><span class="n">apset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Compute atom pair fingerprint database using internal atom pair
selection containing the 4096 most common atom pairs identified in
DrugBank’s compound collection. For details see <code class="highlighter-rouge">?apfp</code>.
The following example uses from this set the 1024 most frequent atom
pairs:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">descnames</span><span class="o">=</span><span class="m">1024</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Alternatively, one can provide any custom atom pair selection. Here, the
1024 most common ones in <code class="highlighter-rouge">apset</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset1024</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">rev</span><span class="p">(</span><span class="n">sort</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">unlist</span><span class="p">(</span><span class="n">as</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)))))[</span><span class="m">1</span><span class="o">:</span><span class="m">1024</span><span class="p">])</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">descnames</span><span class="o">=</span><span class="n">fpset1024</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>A more compact way of storing fingerprints is as character values:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpchar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">apset</span><span class="p">,</span><span class="w">
 </span><span class="n">descnames</span><span class="o">=</span><span class="m">1024</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"character"</span><span class="p">)</span><span class="w"> </span><span class="n">fpchar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Converting a fingerprint database to a matrix and vice versa:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.matrix</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w">
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">fpma</span><span class="p">,</span><span class="w"> </span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Similarity searching and returning Tanimoto similarity coefficients:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Under <code class="highlighter-rouge">method</code> one can choose from several predefined
similarity measures including <em>Tanimoto</em> (default),
<em>Euclidean</em>, <em>Tversky</em> or
<em>Dice</em>. Alternatively, one can pass on custom similarity
functions.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tversky"</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.4</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Example for using a custom similarity function:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">myfct</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="w">
 </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="n">myfct</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Clustering example:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">simMAap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">cid</span><span class="p">(</span><span class="n">apfpset</span><span class="p">),</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">apfpset</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">apfpset</span><span class="p">,</span><span class="w"> </span><span class="n">sorted</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">))</span><span class="w"> 
 </span><span class="n">hc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">as.dist</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">simMAap</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"single"</span><span class="p">)</span><span class="w">
 </span><span class="n">plot</span><span class="p">(</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> </span><span class="n">edgePar</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">horiz</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="fingerprint-e-values">Fingerprint E-values</h2>
<p>The <code class="highlighter-rouge">fpSim</code> function can also return Z-scores, E-values, and p-values
if given a set of score distribution parameters. These parameters can
be computed over an <code class="highlighter-rouge">fpSet</code> with the <code class="highlighter-rouge">genParameters</code> function.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">genParameters</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>
<p>This function will compute all pairwise distances between the given
fingerprints and then fit a Beta distribution to the resulting
Tanimoto scores, conditioned on the number of set bits in each
fingerprint. For large data sets where you would not want to compute
all pairwise distances, you can set what fraction to sample with the
<code class="highlighter-rouge">sampleFraction</code> argument. This step only needs to be done once for
each database of <code class="highlighter-rouge">fpSet</code> objects. Alternatively, if you have a large
database of fingerprints, or you believe that the parameters computed
on a single database are more generally applicable, you can use the
resulting parameters for other databases as well.</p>

<p>Once you have a set of parameters, you can pass them to <code class="highlighter-rouge">fpSim</code> with
the <code class="highlighter-rouge">parameters</code> argument.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w">	</span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span><span class="w">	
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##    similarity    zscore    evalue    pvalue
## 1   1.0000000 6.2418215  0.000000 0.0000000
## 96  0.4719101 1.6075792  6.748413 0.9988273
## 67  0.4288499 1.2297052 12.012285 0.9999939
## 15  0.4275229 1.2180604 12.211967 0.9999950
## 88  0.4247423 1.1936587 12.638193 0.9999968
## 64  0.4187380 1.1409688 13.594938 0.9999988
## 4   0.4166667 1.1227914 13.936692 0.9999991
## 86  0.3978686 0.9578290 17.319191 1.0000000
## 77  0.3970588 0.9507232 17.476453 1.0000000
## 69  0.3940000 0.9238806 18.079243 1.0000000
</code></pre>
</div>

<p>This will then return a data frame with the similarity, Z-score,
E-value, and p-value. You can change which value will be used as a
cutoff and to sort by by setting the argument <code class="highlighter-rouge">scoreType</code> to one of
these scores. In this way you could set an E-value cutoff of 0.04 for
example.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w">	</span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.04</span><span class="p">,</span><span class="w"> </span><span class="n">scoreType</span><span class="o">=</span><span class="s2">"evalue"</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span><span class="w">	
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   similarity   zscore evalue pvalue
## 1          1 6.241822      0      0
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="pairwise-compound-comparisons-with-pubchem-fingerprints">Pairwise Compound Comparisons with PubChem Fingerprints</h2>

<p>The <code class="highlighter-rouge">fpSim</code> function computes the similarity coefficients
(<em>e.g.</em> Tanimoto) for pairwise comparisons of binary fingerprints. For
this data type, <em>c</em> is the number of “on-bits” common in both
compounds, and <em>a</em> and <em>b</em> are the numbers of their unique
“on-bits”. Currently, the PubChem fingerprints need to be provided (here
PubChem’s SD files) and cannot be computed from scratch in
<code class="highlighter-rouge">ChemmineR</code>. The PubChem fingerprint specifications can
be loaded with <code class="highlighter-rouge">data(pubchemFPencoding)</code>.</p>

<p>Convert base 64 encoded PubChem fingerprints to
<code class="highlighter-rouge">character</code> vector, <code class="highlighter-rouge">matrix</code> or
<code class="highlighter-rouge">FPset</code> object:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w">
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fp2bit</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fp2bit</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fp2bit</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 881 bit "FPset" of type "pubchem" with 100 molecules
</code></pre>
</div>

<p>Pairwise compound structure comparisons:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##    650002 
## 0.5364807
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="similarity-searching-with-pubchem-fingerprints">Similarity Searching with PubChem Fingerprints</h2>

<p>Similarly, the <code class="highlighter-rouge">fpSim</code> function provides search
functionality for PubChem fingerprints:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="o">=</span><span class="m">6</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##    650065    650066    650035    650019    650012    650046 
## 1.0000000 0.9944751 0.7435897 0.7432432 0.7230047 0.7142857
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="visualize-similarity-search-results">Visualize Similarity Search Results</h2>

<p>The <code class="highlighter-rouge">cmp.search</code> function allows to visualize the
chemical structures for the search results. Similar but more flexible
chemical structure rendering functions are <code class="highlighter-rouge">plot</code> and
<code class="highlighter-rouge">sdf.visualize</code> described above. By setting the visualize
argument in <code class="highlighter-rouge">cmp.search</code> to <code class="highlighter-rouge">TRUE</code>, the
matching compounds and their scores can be visualized with a standard
web browser. Depending on the <code class="highlighter-rouge">visualize.browse</code>
argument, an URL will be printed or a webpage will be opened showing the
structures of the matching compounds.</p>

<p>View similarity search results in R’s graphics device:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
 </span><span class="n">cid</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Assure compound name consistency among objects. 
</span><span class="w">
 </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="nf">names</span><span class="p">(</span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))],</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/search_result-1.png" alt="" />\</p>

<p>View results online with Chemmine Tools:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">similarities</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
 </span><span class="n">sdf.visualize</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="n">similarities</span><span class="p">[,</span><span class="m">1</span><span class="p">]])</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="clustering">Clustering</h1>

<h2 id="clustering-identical-or-very-similar-compounds">Clustering Identical or Very Similar Compounds</h2>

<p>Often it is of interest to identify very similar or identical compounds
in a compound set. The <code class="highlighter-rouge">cmp.duplicated</code> function can be
used to quickly identify very similar compounds in atom pair sets, which
will be frequently, but not necessarily, identical compounds.</p>

<p>Identify compounds with identical AP sets:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.duplicated</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">1</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="c1"># Returns AP duplicates as logical vector 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] FALSE FALSE FALSE FALSE
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.duplicated</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> </span><span class="c1"># Returns AP duplicates as data frame 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##      ids CLSZ_100 CLID_100
## 1 650082        1        1
## 2 650059        2        2
## 3 650060        2        2
## 4 650010        1        3
</code></pre>
</div>

<p>Plot the structure of two pairs of duplicates:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s2">"650059"</span><span class="p">,</span><span class="s2">"650060"</span><span class="p">,</span><span class="w"> </span><span class="s2">"650065"</span><span class="p">,</span><span class="w"> </span><span class="s2">"650066"</span><span class="p">)],</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/duplicates-1.png" alt="" />\</p>

<p>Remove AP duplicates from SDFset and APset objects:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">apdups</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.duplicated</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
 </span><span class="n">sdfset</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="o">!</span><span class="n">apdups</span><span class="p">)];</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="o">!</span><span class="n">apdups</span><span class="p">)]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "SDFset" with 96 molecules
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "APset" with 96 molecules
</code></pre>
</div>

<p>Alternatively, one can identify duplicates via other descriptor types if
they are provided in the data block of an imported SD file. For
instance, one can use here fingerprints, InChI, SMILES or other
molecular representations. The following examples show how to enumerate
by identical InChI strings, SMILES strings and molecular formula,
respectively.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">datablocktag</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w">
 </span><span class="n">tag</span><span class="o">=</span><span class="s2">"PUBCHEM_NIST_INCHI"</span><span class="p">))</span><span class="w">
 </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">datablocktag</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="o">=</span><span class="s2">"PUBCHEM_OPENEYE_CAN_SMILES"</span><span class="p">))</span><span class="w"> 
 </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">datablocktag</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="o">=</span><span class="s2">"PUBCHEM_MOLECULAR_FORMULA"</span><span class="p">))</span><span class="w"> 
 </span><span class="n">count</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
##  C10H9FN2O2S   C11H12N4OS    C11H13NO4 C12H11ClN2OS 
##            1            1            1            1
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="binning-clustering">Binning Clustering</h2>

<p>Compound libraries can be clustered into discrete similarity groups with
the binning clustering function <code class="highlighter-rouge">cmp.cluster</code>. The
function accepts as input an atom pair (<code class="highlighter-rouge">APset</code>) or a
fingerprint (<code class="highlighter-rouge">FPset</code>) descriptor database as well as a
similarity threshold. The binning clustering result is returned in form
of a data frame. Single linkage is used for cluster joining. The
function calculates the required compound-to-compound distance
information on the fly, while a memory-intensive distance matrix is only
created upon user request via the <code class="highlighter-rouge">save.distances</code>
argument (see below).</p>

<p>Because an optimum similarity threshold is often not known, the
<code class="highlighter-rouge">cmp.cluster</code> function can calculate cluster results for
multiple cutoffs in one step with almost the same speed as for a single
cutoff. This can be achieved by providing several cutoffs under the
cutoff argument. The clustering results for the different cutoffs will
be stored in one data frame.</p>

<p>One may force the <code class="highlighter-rouge">cmp.cluster</code> function to calculate and
store the distance matrix by supplying a file name to the
<code class="highlighter-rouge">save.distances</code> argument. The generated distance matrix
can be loaded and passed on to many other clustering methods available
in R, such as the hierarchical clustering function
<code class="highlighter-rouge">hclust</code> (see below).</p>

<p>If a distance matrix is available, it may also be supplied to
<code class="highlighter-rouge">cmp.cluster</code> via the <code class="highlighter-rouge">use.distances</code>
argument. This is useful when one has a pre-computed distance matrix
either from a previous call to <code class="highlighter-rouge">cmp.cluster</code> or from
other distance calculation subroutines.</p>

<p>Single-linkage binning clustering with one or multiple cutoffs:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## sorting result...
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##       ids CLSZ_0.7 CLID_0.7 CLSZ_0.8 CLID_0.8 CLSZ_0.9 CLID_0.9
## 48 650049        2       48        2       48        2       48
## 49 650050        2       48        2       48        2       48
## 54 650059        2       54        2       54        2       54
## 55 650060        2       54        2       54        2       54
## 56 650061        2       56        2       56        2       56
## 57 650062        2       56        2       56        2       56
## 58 650063        2       58        2       58        2       58
## 59 650064        2       58        2       58        2       58
## 60 650065        2       60        2       60        2       60
## 61 650066        2       60        2       60        2       60
## 1  650001        1        1        1        1        1        1
## 2  650002        1        2        1        2        1        2
</code></pre>
</div>

<p>Clustering of <code class="highlighter-rouge">FPset</code> objects with multiple cutoffs. This
method allows to call various similarity methods provided by the
<code class="highlighter-rouge">fpSim</code> function. For details consult
<code class="highlighter-rouge">?fpSim</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w">
 </span><span class="n">clusters2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## sorting result...
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters2</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##       ids CLSZ_0.5 CLID_0.5 CLSZ_0.7 CLID_0.7 CLSZ_0.9 CLID_0.9
## 69 650074       14       11        2       69        1       69
## 79 650085       14       11        2       69        1       79
## 11 650011       14       11        1       11        1       11
## 15 650015       14       11        1       15        1       15
## 45 650046       14       11        1       45        1       45
## 47 650048       14       11        1       47        1       47
## 51 650054       14       11        1       51        1       51
## 53 650058       14       11        1       53        1       53
## 64 650069       14       11        1       64        1       64
## 65 650070       14       11        1       65        1       65
## 67 650072       14       11        1       67        1       67
## 86 650092       14       11        1       86        1       86
</code></pre>
</div>

<p>Sames as above, but using Tversky similarity measure:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w"> 
								  </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tversky"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="o">=</span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## sorting result...
</code></pre>
</div>

<p>Return cluster size distributions for each cutoff:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cluster.sizestat</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">cluster.result</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   cluster size count
## 1            1    90
## 2            2     5
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cluster.sizestat</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">cluster.result</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   cluster size count
## 1            1    90
## 2            2     5
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cluster.sizestat</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">cluster.result</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   cluster size count
## 1            1    90
## 2            2     5
</code></pre>
</div>

<p>Enforce calculation of distance matrix:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.65</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.3</span><span class="p">),</span><span class="w">
 </span><span class="n">save.distances</span><span class="o">=</span><span class="s2">"distmat.rda"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Saves distance matrix to file "distmat.rda" in current working directory. 
</span><span class="w"> </span><span class="n">load</span><span class="p">(</span><span class="s2">"distmat.rda"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Loads distance matrix. 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="jarvis-patrick-clustering">Jarvis-Patrick Clustering</h2>

<p>The Jarvis-Patrick clustering algorithm is widely used in
cheminformatics [@greycite13371]. It requires a nearest neighbor table, which consists
of <em>j</em> nearest neighbors for each item (<em>e.g.</em> compound).
The nearest neighbor table is then used to join items into clusters when
they meet the following requirements: (a) they are contained in each
other’s neighbor list and (b) they share at least <em>k</em>
nearest neighbors. The values for <em>j</em> and
<em>k</em> are user-defined parameters. The
<code class="highlighter-rouge">jarvisPatrick</code> function implemented in
<code class="highlighter-rouge">ChemmineR</code> takes a nearest neighbor table generated by
<code class="highlighter-rouge">nearestNeighbors</code>, which works for
<code class="highlighter-rouge">APset</code> and <code class="highlighter-rouge">FPset</code> objects. This function
takes either the standard Jarvis-Patrick <em>j</em> parameter
(as the <code class="highlighter-rouge">numNbrs</code> parameter), or else a
<code class="highlighter-rouge">cutoff</code> value, which is an extension to the basic
algorithm that we have added. Given a cutoff value, the nearest neighbor
table returned contains every neighbor with a similarity greater than
the cutoff value, for each item. This allows one to generate tighter
clusters and to minimize certain limitations of this method, such as
false joins of completely unrelated items when operating on small data
sets. The <code class="highlighter-rouge">trimNeighbors</code> function can also be used to
take an existing nearest neighbor table and remove all neighbors whose
similarity value is below a given cutoff value. This allows one to
compute a very relaxed nearest neighbor table initially, and then
quickly try different refinements later.</p>

<p>In case an existing nearest neighbor matrix needs to be used, the
<code class="highlighter-rouge">fromNNMatrix</code> function can be used to transform it into
the list structure that <code class="highlighter-rouge">jarvisPatrick</code> requires. The
input matrix must have a row for each compound, and each row should be
the index values of the neighbors of compound represented by that row.
The names of each compound can also be given through the
<code class="highlighter-rouge">names</code> argument. If not given, it will attempt to use
the <code class="highlighter-rouge">rownames</code> of the given matrix.</p>

<p>The <code class="highlighter-rouge">jarvisPatrick</code> function also allows one to relax
some of the requirements of the algorithm through the
<code class="highlighter-rouge">mode</code> parameter. When set to “a1a2b”, then all
requirements are used. If set to “a1b”, then (a) is relaxed to a
unidirectional requirement. Lastly, if <code class="highlighter-rouge">mode</code> is set to
“b”, then only requirement (b) is used, which means that all pairs of
items will be checked to see if (b) is satisfied between them. The size
of the clusters generated by the different methods increases in this
order: “a1a2b” &lt; “a1b” &lt; “b”. The run time of method “a1a2b” follows a
close to linear relationship, while it is nearly quadratic for the much
more exhaustive method “b”. Only methods “a1a2b” and “a1b” are suitable
for clustering very large data sets (e.g. &gt;50,000 items) in a
reasonable amount of time.</p>

<p>An additional extension to the algorithm is the ability to set the
linkage mode. The <code class="highlighter-rouge">linkage</code> parameter can be one of
“single”, “average”, or “complete”, for single linkage, average linkage
and complete linkage merge requirements, respectively. In the context of
Jarvis-Patrick, average linkage means that at least half of the pairs
between the clusters under consideration must meet requirement (b).
Similarly, for complete linkage, all pairs must requirement (b). Single
linkage is the normal case for Jarvis-Patrick and just means that at
least one pair must meet requirement (b).</p>

<p>The output is a cluster <code class="highlighter-rouge">vector</code> with the item labels in
the name slot and the cluster IDs in the data slot. There is a utility
function called <code class="highlighter-rouge">byCluster</code>, which takes out cluster
vector output by <code class="highlighter-rouge">jarvisPatrick</code> and transforms it into a
list of vectors. Each slot of the list is named with a cluster id and
the vector contains the cluster members. By default the function
excludes singletons from the output, but they can be included by setting
<code class="highlighter-rouge">excludeSingletons</code>=FALSE`.</p>

<p>Load/create sample <code class="highlighter-rouge">APset</code> and <code class="highlighter-rouge">FPset</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Standard Jarvis-Patrick clustering on <code class="highlighter-rouge">APset</code> and
<code class="highlighter-rouge">FPset</code> objects:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">nearestNeighbors</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="n">numNbrs</span><span class="o">=</span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="s2">"a1a2b"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 650001 650002 650003 650004 650005 650006 650007 650008 650009 650010 650011 650012 650013 650014 
##      1      2      3      4      5      6      7      8      9     10     11     12     13     14 
## 650015 650016 650017 650019 650020 650021 650022 650023 650024 650025 650026 650027 650028 650029 
##     11     15     16     17     18     19     20     21     22     23     24     25     26     27 
## 650030 650031 650032 650033 650034 650035 650036 650037 650038 650039 650040 650041 650042 650043 
##     28     29     30     31     32     33     34     35     36     37     38     39     40     41 
## 650044 650045 650046 650047 650048 650049 650050 650052 650054 650056 650058 650059 650060 650061 
##     42     43     44     45     46     47     48     49     50     51     52     53     54     55 
## 650062 650063 650064 650065 650066 650067 650068 650069 650070 650071 650072 650073 650074 650075 
##     56     57     58     59     60     61     62     63     64     65     66     67     68     69 
## 650076 650077 650078 650079 650080 650081 650082 650083 650085 650086 650087 650088 650089 650090 
##     70     71     72     73     74     75     76     77     78     79     80     81     82     83 
## 650091 650092 650093 650094 650095 650096 650097 650098 650099 650100 650101 650102 650103 650104 
##     84     85     86     87     88     89     90     91     92     93     94     95     96     97 
## 650105 650106 
##     98     99
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="c1">#Using "APset" 
</span><span class="w">
 </span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">nearestNeighbors</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="n">numNbrs</span><span class="o">=</span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="s2">"a1a2b"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 650001 650002 650003 650004 650005 650006 650007 650008 650009 650010 650011 650012 650013 650014 
##      1      2      3      4      5      6      7      8      9     10     11     12     13     14 
## 650015 650016 650017 650019 650020 650021 650022 650023 650024 650025 650026 650027 650028 650029 
##     11     15     16     17     18     19     20     21     22     23     24     25     26     27 
## 650030 650031 650032 650033 650034 650035 650036 650037 650038 650039 650040 650041 650042 650043 
##     28     29     30     31     32     33     34     35     36     37     38     39     40     41 
## 650044 650045 650046 650047 650048 650049 650050 650052 650054 650056 650058 650059 650060 650061 
##     42     43     44     45     46     47     48     49     50     51     52     53     54     55 
## 650062 650063 650064 650065 650066 650067 650068 650069 650070 650071 650072 650073 650074 650075 
##     56     57     58     59     60     61     62     63     64     65     66     67     68     69 
## 650076 650077 650078 650079 650080 650081 650082 650083 650085 650086 650087 650088 650089 650090 
##     70     71     72     73     74     75     76     77     78     79     80     81     82     83 
## 650091 650092 650093 650094 650095 650096 650097 650098 650099 650100 650101 650102 650103 650104 
##     84     85     86     87     88     89     90     91     92     93     94      1     95     96 
## 650105 650106 
##     97     98
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="c1">#Using "FPset" 
</span></code></pre>
</div>

<p>The following example runs Jarvis-Patrick clustering with a minimum
similarity <code class="highlighter-rouge">cutoff</code> value (here Tanimoto coefficient). In
addition, it uses the much more exhaustive <code class="highlighter-rouge">"b"</code> method
that generates larger cluster sizes, but significantly increased the run
time. For more details, consult the corresponding help file with
<code class="highlighter-rouge">?jarvisPatrick</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cl</span><span class="o">&lt;-</span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">nearestNeighbors</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.6</span><span class="p">,</span><span class="w">
 </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">),</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s2">"b"</span><span class="p">)</span><span class="w">
 </span><span class="n">byCluster</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`11`
## [1] "650011" "650092"
## 
## $`15`
## [1] "650015" "650069"
## 
## $`45`
## [1] "650046" "650054"
## 
## $`48`
## [1] "650049" "650050"
## 
## $`52`
## [1] "650059" "650060"
## 
## $`53`
## [1] "650061" "650062"
## 
## $`54`
## [1] "650063" "650064"
## 
## $`55`
## [1] "650065" "650066"
## 
## $`62`
## [1] "650074" "650085"
</code></pre>
</div>

<p>Output nearest neighbor table (<code class="highlighter-rouge">matrix</code>):</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nnm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nearestNeighbors</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="n">numNbrs</span><span class="o">=</span><span class="m">6</span><span class="p">)</span><span class="w">
 </span><span class="n">nnm</span><span class="o">$</span><span class="n">names</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] "650001" "650002" "650003" "650004"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nnm</span><span class="o">$</span><span class="n">ids</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## NULL
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nnm</span><span class="o">$</span><span class="n">similarities</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     650001    650102    650072    650015    650094    650069
## sim      1 0.4719101 0.4288499 0.4275229 0.4247423 0.4187380
## sim      1 0.4343891 0.4246575 0.4216867 0.3939394 0.3922078
## sim      1 0.4152249 0.3619303 0.3610315 0.3424242 0.3367089
## sim      1 0.5791045 0.4973958 0.4192708 0.4166667 0.4104683
</code></pre>
</div>

<p>Trim nearest neighbor table:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nnm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trimNeighbors</span><span class="p">(</span><span class="n">nnm</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.4</span><span class="p">)</span><span class="w"> 
 </span><span class="n">nnm</span><span class="o">$</span><span class="n">similarities</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     650001    650102    650072    650015    650094    650069
## sim      1 0.4719101 0.4288499 0.4275229 0.4247423 0.4187380
## sim      1 0.4343891 0.4246575 0.4216867        NA        NA
## sim      1 0.4152249        NA        NA        NA        NA
## sim      1 0.5791045 0.4973958 0.4192708 0.4166667 0.4104683
</code></pre>
</div>

<p>Perform clustering on precomputed nearest neighbor table:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">nnm</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s2">"b"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 650001 650002 650003 650004 650005 650006 650007 650008 650009 650010 650011 650012 650013 650014 
##      1      2      3      4      5      6      7      8      9     10     11     12     13     14 
## 650015 650016 650017 650019 650020 650021 650022 650023 650024 650025 650026 650027 650028 650029 
##     11     15     16     17     18     19     20     21     22     23     24     25     26     27 
## 650030 650031 650032 650033 650034 650035 650036 650037 650038 650039 650040 650041 650042 650043 
##     28     29     30     31     32     33     34     35     36     37     38     39     40     41 
## 650044 650045 650046 650047 650048 650049 650050 650052 650054 650056 650058 650059 650060 650061 
##     42     43     11     44     11     45     46     47     48     49     50     51     52     53 
## 650062 650063 650064 650065 650066 650067 650068 650069 650070 650071 650072 650073 650074 650075 
##     54     55     56     57     57     58     59     11     60     61     62     63     64     65 
## 650076 650077 650078 650079 650080 650081 650082 650083 650085 650086 650087 650088 650089 650090 
##     66     67     68     69     37     70     71     72     64     73     74     75     76     77 
## 650091 650092 650093 650094 650095 650096 650097 650098 650099 650100 650101 650102 650103 650104 
##     78     11     79     80     81     82     83     84     85     86     87      1     88     89 
## 650105 650106 
##     90     91
</code></pre>
</div>

<p>Using a user defined nearest neighbor matrix:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="n">dimnames</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s1">'one'</span><span class="p">,</span><span class="s1">'two'</span><span class="p">)))</span><span class="w"> 
 </span><span class="n">nn</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     [,1] [,2]
## one    1    2
## two    2    1
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">byCluster</span><span class="p">(</span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">fromNNMatrix</span><span class="p">(</span><span class="n">nn</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`1`
## [1] "one" "two"
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="multi-dimensional-scaling-mds">Multi-Dimensional Scaling (MDS)</h2>

<p>To visualize and compare clustering results, the
<code class="highlighter-rouge">cluster.visualize</code> function can be used. The function
performs Multi-Dimensional Scaling (MDS) and visualizes the results in
form of a scatter plot. It requires as input an <code class="highlighter-rouge">APset</code>,
a clustering result from <code class="highlighter-rouge">cmp.cluster</code>, and a cutoff for
the minimum cluster size to consider in the plot. To help determining a
proper cutoff size, the <code class="highlighter-rouge">cluster.sizestat</code> function is
provided to generate cluster size statistics.</p>

<p>MDS clustering and scatter plot:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cluster.visualize</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">size.cutoff</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># Color codes clusters with at least two members. 
</span><span class="w"> </span><span class="n">cluster.visualize</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># Plots all items.
</span></code></pre>
</div>

<p>Create a 3D scatter plot of MDS result:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">scatterplot3d</span><span class="p">)</span><span class="w"> 
 </span><span class="n">coord</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cluster.visualize</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">size.cutoff</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">dimensions</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
 </span><span class="n">scatterplot3d</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/mds_scatter-1.png" alt="" />\</p>

<p>Interactive 3D scatter plot with Open GL (graphics not evaluated here):</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">rgl</span><span class="p">)</span><span class="w"> </span><span class="n">rgl.open</span><span class="p">();</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span><span class="p">;</span><span class="w">
 </span><span class="n">par3d</span><span class="p">(</span><span class="n">windowRect</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="m">640</span><span class="o">+</span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="m">640</span><span class="o">+</span><span class="n">offset</span><span class="p">))</span><span class="w"> 
 </span><span class="n">rm</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span><span class="w">
 </span><span class="n">rgl.clear</span><span class="p">()</span><span class="w"> 
 </span><span class="n">rgl.viewpoint</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="n">phi</span><span class="o">=</span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">fov</span><span class="o">=</span><span class="m">60</span><span class="p">,</span><span class="w"> </span><span class="n">zoom</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
 </span><span class="n">spheres3d</span><span class="p">(</span><span class="n">coord</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">coord</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">coord</span><span class="p">[,</span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="n">radius</span><span class="o">=</span><span class="m">0.03</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">coord</span><span class="p">[,</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">shininess</span><span class="o">=</span><span class="m">20</span><span class="p">)</span><span class="w"> 
 </span><span class="n">aspect3d</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> 
 </span><span class="n">axes3d</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w">
 </span><span class="n">title3d</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w">
 </span><span class="n">bg3d</span><span class="p">(</span><span class="s2">"white"</span><span class="p">)</span><span class="w"> </span><span class="c1"># To save a snapshot of the graph, one can use the command rgl.snapshot("test.png").
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="clustering-with-other-algorithms">Clustering with Other Algorithms</h2>

<p><code class="highlighter-rouge">ChemmineR</code> allows the user to take advantage of the wide
spectrum of clustering utilities available in R. An example on how to
perform hierarchical clustering with the hclust function is given
below.</p>

<p>Create atom pair distance matrix:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">dummy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">save.distances</span><span class="o">=</span><span class="s2">"distmat.rda"</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## sorting result...
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">load</span><span class="p">(</span><span class="s2">"distmat.rda"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Hierarchical clustering with <code class="highlighter-rouge">hclust</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">hc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">as.dist</span><span class="p">(</span><span class="n">distmat</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"single"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">hc</span><span class="p">[[</span><span class="s2">"labels"</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Assign correct item labels 
</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> </span><span class="n">edgePar</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">horiz</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/hclust-1.png" alt="" />\</p>

<p>Instead of atom pairs one can use PubChem’s fingerprints for clustering:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">simMA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">cid</span><span class="p">(</span><span class="n">fpset</span><span class="p">),</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">sorted</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">))</span><span class="w">
 </span><span class="n">hc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">as.dist</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">simMA</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"single"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">plot</span><span class="p">(</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> </span><span class="n">edgePar</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">horiz</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Plot dendrogram with heatmap (here similarity matrix):</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">gplots</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Attaching package: 'gplots'
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## The following object is masked from 'package:stats':
## 
##     lowess
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">heatmap.2</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">distmat</span><span class="p">,</span><span class="w"> </span><span class="n">Rowv</span><span class="o">=</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> </span><span class="n">Colv</span><span class="o">=</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> 
			  </span><span class="n">col</span><span class="o">=</span><span class="n">colorpanel</span><span class="p">(</span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="s2">"darkblue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"yellow"</span><span class="p">,</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w"> 
			  </span><span class="n">density.info</span><span class="o">=</span><span class="s2">"none"</span><span class="p">,</span><span class="w"> </span><span class="n">trace</span><span class="o">=</span><span class="s2">"none"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="ChemmineR_files/figure-html/heatmap-1.png" alt="" />\</p>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="searching-pubchem">Searching PubChem</h1>

<h2 id="get-compounds-from-pubchem-by-id">Get Compounds from PubChem by Id</h2>

<p>The function <code class="highlighter-rouge">getIds</code> accepts one or more numeric PubChem
compound ids and downloads the corresponding compounds from PubChem
Power User Gateway (PUG) returning results in an <code class="highlighter-rouge">SDFset</code>
container. The ChemMine Tools web service is used as an intermediate, to
translate queries from plain HTTP POST to a PUG SOAP query.</p>

<p>Fetch 2 compounds from PubChem:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">compounds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">getIds</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">111</span><span class="p">,</span><span class="m">123</span><span class="p">))</span><span class="w">
 </span><span class="n">compounds</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="search-a-smiles-query-in-pubchem">Search a SMILES Query in PubChem</h2>

<p>The function <code class="highlighter-rouge">searchString</code> accepts one SMILES string
(Simplified Molecular Input Line Entry Specification) and performs a
&gt;0.95 similarity PubChem fingerprint search, returning the hits in an
<code class="highlighter-rouge">SDFset</code> container. The ChemMine Tools web service is
used as an intermediate, to translate queries from plain HTTP POST to a
PubChem Power User Gateway (PUG) query.</p>

<p>Search a SMILES string on PubChem:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">compounds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">searchString</span><span class="p">(</span><span class="s2">"CC(=O)OC1=CC=CC=C1C(=O)O"</span><span class="p">)</span><span class="w"> </span><span class="n">compounds</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="search-an-sdf-query-in-pubchem">Search an SDF Query in PubChem</h2>

<p>The function <code class="highlighter-rouge">searchSim</code> performs a PubChem similarity
search just like <code class="highlighter-rouge">searchString</code>, but accepts a query in
an <code class="highlighter-rouge">SDFset</code> container. If the query contains more than
one compound, only the first is searched.</p>

<p>Search an <code class="highlighter-rouge">SDFset</code> container on PubChem:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">sdfsample</span><span class="p">);</span><span class="w"> 
 </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfsample</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> 
 </span><span class="n">compounds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">searchSim</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> 
 </span><span class="n">compounds</span><span class="w"> 
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="chemmine-tools-r-interface">ChemMine Tools R Interface</h1>

<p>ChemMine Web Tools is an online service for analyzing and clustering small molecules. It provides numerous cheminformatics tools which can be used directly on the website, or called remotely from within R. When called within R jobs are sent remotely to a queue on a compute cluster at UC Riverside, which is a free service offered to <code class="highlighter-rouge">ChemmineR</code> users.
The website is free and open to all users and is available at <a href="http://chemmine.ucr.edu">http://chemmine.ucr.edu</a>. When new tools are added to the service, they automatically become availiable within <code class="highlighter-rouge">ChemmineR</code> without updating your local R package.</p>

<p>List all available tools:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">listCMTools</span><span class="p">()</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##      Category                           Name      Input     Output
## 1      Upload                Upload CSV Data  character data.frame
## 2      Upload      Upload Tab Delimited Data  character data.frame
## 3  Properties             JoeLib Descriptors     SDFset data.frame
## 4  Properties          OpenBabel Descriptors     SDFset data.frame
## 5  Clustering             Binning Clustering     SDFset  character
## 6  Clustering Multidimensional Scaling (MDS)     SDFset  character
## 7  Clustering        Numeric Data Clustering     SDFset  character
## 8  Clustering        Hierarchical Clustering     SDFset  character
## 9      Search                  pubchemID2SDF data.frame     SDFset
## 10   Plotting               Graph Visualizer     igraph  character
## 11 Properties           ChemmineR Properties     SDFset data.frame
## 12  ChemmineR                  sdf.visualize     SDFset     SDFset
## 13     Search                      EI Search     SDFset    integer
## 14     Search             Fingerprint Search     SDFset    integer
</code></pre>
</div>

<p>Show options and description for a tool. This also provides an example function call which can be copied
verbatim, and changed as necessary:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">toolDetails</span><span class="p">(</span><span class="s2">"Fingerprint Search"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Category:		Search
## Name:			Fingerprint Search
## Input R Object:		SDFset
## Input mime type:	chemical/x-mdl-sdfile
## Output R Object:	integer
## Output mime type:	text/fp.search.result
## ###### BEGIN DESCRIPTION ######
## PubChem Fingerprint Search
## ####### END DESCRIPTION #######
## Option 1: 'Similarity Cutoff'
## Allowed Values:  '0.5' '0.6' '0.7' '0.8' '0.85' '0.9' '0.91' '0.92' '0.93' '0.94' '0.95' '0.96' '0.97' '0.98' '0.99'
## Option 2: 'Max Compounds Returned'
## Allowed Values:  '10' '50' '100' '200' '1000'
## Example function call:
## 	job &lt;- launchCMTool(
## 		'Fingerprint Search',
## 		SDFset,
## 		'Similarity Cutoff'='0.5',
## 		'Max Compounds Returned'='10'
## 	)
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="launch-a-job">Launch a Job</h2>

<p>When a job is launched it returns a job token which refers to the running job on the UC Riverside cluster. You can check the status of a job or obtain the results as follows. If <code class="highlighter-rouge">result</code> is called on a job that is still running, it will loop internally until the job is completed, and then return the result.</p>

<p>Launch the tool <code class="highlighter-rouge">pubchemID2SDF</code> to obtain the structure for PubChem cid 2244:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">job1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">launchCMTool</span><span class="p">(</span><span class="s2">"pubchemID2SDF"</span><span class="p">,</span><span class="w"> </span><span class="m">2244</span><span class="p">)</span><span class="w">
</span><span class="n">status</span><span class="p">(</span><span class="n">job1</span><span class="p">)</span><span class="w">
</span><span class="n">result1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">result</span><span class="p">(</span><span class="n">job1</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Use the previous result to search PubChem for similar compounds:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">job2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">launchCMTool</span><span class="p">(</span><span class="s1">'Fingerprint Search'</span><span class="p">,</span><span class="w"> </span><span class="n">result1</span><span class="p">,</span><span class="w"> </span><span class="s1">'Similarity Cutoff'</span><span class="o">=</span><span class="m">0.95</span><span class="p">,</span><span class="w"> </span><span class="s1">'Max Compounds Returned'</span><span class="o">=</span><span class="m">200</span><span class="p">)</span><span class="w">
</span><span class="n">result2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">result</span><span class="p">(</span><span class="n">job2</span><span class="p">)</span><span class="w">
</span><span class="n">job3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">launchCMTool</span><span class="p">(</span><span class="s2">"pubchemID2SDF"</span><span class="p">,</span><span class="w"> </span><span class="n">result2</span><span class="p">)</span><span class="w">
</span><span class="n">result3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">result</span><span class="p">(</span><span class="n">job3</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Compute OpenBabel descriptors for these search results:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">job4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">launchCMTool</span><span class="p">(</span><span class="s2">"OpenBabel Descriptors"</span><span class="p">,</span><span class="w"> </span><span class="n">result3</span><span class="p">)</span><span class="w">
</span><span class="n">result4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">result</span><span class="p">(</span><span class="n">job4</span><span class="p">)</span><span class="w">
</span><span class="n">result4</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,]</span><span class="w"> </span><span class="c1"># show first 10 lines of result
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##         cid abonds atoms bonds dbonds HBA1 HBA2 HBD   logP      MR       MW nF sbonds tbonds  TPSA
## 1      2244      6    21    21      2   12    4   1 1.3101 44.9003 180.1574  0     13      0 63.60
## 2      5161     12    29    30      2   15    5   2 2.3096 66.8248 258.2262  0     16      0 83.83
## 3     68484      6    24    24      2   14    4   0 1.3985 49.2205 194.1840  0     16      0 52.60
## 4     10745     12    34    35      3   18    6   1 2.5293 76.3008 300.2629  0     20      0 89.90
## 5    135269      6    30    30      2   18    4   1 2.4804 59.3213 222.2372  0     22      0 63.60
## 6     67252      6    22    22      1   13    3   1 1.7835 44.7003 166.1739  0     15      0 46.53
## 7    171511      6    25    23      2   16    5   2 1.2458 47.9481 222.4777  0     15      0 72.83
## 8   3053800      6    39    39      2   24    4   1 3.6507 73.7423 264.3169  0     31      0 63.60
## 9  71586929      6    38    33      2   29    7   6 1.7922 60.7157 294.2140  0     25      0 91.29
## 10    78094      6    24    24      2   14    4   1 1.6185 49.8663 194.1840  0     16      0 63.60
</code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h2 id="view-job-result-in-browser">View Job Result in Browser</h2>

<p>The function <code class="highlighter-rouge">browseJob</code> launches a web browser to view the results of a job online, just as if they
had been run from the ChemMine Tools website itself. If you also want the result data within R, you must first call
the <code class="highlighter-rouge">result</code> object from within R before calling <code class="highlighter-rouge">browseJob</code>. Once <code class="highlighter-rouge">browseJob</code> has been called on a job token,
the results are no longer accessible within R.</p>

<p>If you have an account on ChemMine Tools and would like to save the web results from your job, you must first login to your account within the default web browser on your system before you launch <code class="highlighter-rouge">browseJob</code>. The job will then be assigned automatically to the currently logged in account.</p>

<p>View OpenBabel descriptors online:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">browseJob</span><span class="p">(</span><span class="n">job4</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Perform binning clustering and visualize result online:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">job5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">launchCMTool</span><span class="p">(</span><span class="s2">"Binning Clustering"</span><span class="p">,</span><span class="w"> </span><span class="n">result3</span><span class="p">,</span><span class="w"> </span><span class="s1">'Similarity Cutoff'</span><span class="o">=</span><span class="m">0.9</span><span class="p">)</span><span class="w">
</span><span class="n">browseJob</span><span class="p">(</span><span class="n">job5</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="version-information">Version Information</h1>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">sessionInfo</span><span class="p">()</span><span class="w">
</span></code></pre>
</div>

<p>R version 3.2.3 (2015-12-10)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 14.04.3 LTS</p>

<p>locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8     <br />
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8 <br />
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C            <br />
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C</p>

<p>attached base packages:
[1] stats     graphics  utils     datasets  grDevices methods   base</p>

<p>other attached packages:
[1] gplots_2.17.0        scatterplot3d_0.3-36 RSQLite_1.0.0        DBI_0.3.1         <br />
[5] ggplot2_2.0.0        fmcsR_1.12.0         ChemmineOB_1.8.0     ChemmineR_2.23.1  <br />
[9] BiocStyle_1.8.0</p>

<p>loaded via a namespace (and not attached):
 [1] Rcpp_0.12.3        knitr_1.12         magrittr_1.5       zlibbioc_1.16.0    munsell_0.4.2   <br />
 [6] colorspace_1.2-6   rjson_0.2.15       stringr_1.0.0      plyr_1.8.3         caTools_1.17.1  <br />
[11] tools_3.2.3        parallel_3.2.3     grid_3.2.3         gtable_0.1.2       KernSmooth_2.23-15
[16] gtools_3.5.0       htmltools_0.3      yaml_2.1.13        digest_0.6.9       formatR_1.2.1   <br />
[21] codetools_0.2-14   bitops_1.0-6       RCurl_1.95-4.7     evaluate_0.8       rmarkdown_0.9.2 <br />
[26] gdata_2.17.0       stringi_1.0-1      scales_0.3.0</p>

<div align="right">[Back to Table of Contents]()</div>

<h1 id="funding">Funding</h1>

<p>This software was developed with funding from the National Science
Foundation: <a href="http://www.nsf.gov/awardsearch/showAward.do?AwardNumber=0957099">ABI-0957099</a>,
2010-0520325 and IGERT-0504249.</p>

<h1 id="references">References</h1>



<div class="tags">
    
</div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2016 Thomas Girke. All rights reserved. <br />
 Site last generated: Jul 1, 2016 <br />
<p><img src="/manuals/images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>

    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>
    <script>
    jQuery(function ($) {
        $('.post-content').annotator()
                .annotator('setupPlugins', {tokenUrl: 'http://example.com/api/token'})
    });
    </script>
</body>

</html>